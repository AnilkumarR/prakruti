<?xml version="1.0" encoding="utf-8"  ?>
<openerp>
 <data>
     
        <!--   Search View       -->
        <record model="ir.ui.view" id="view_prakruti_sales_quotation_search">
            <field name="name">prakruti.sales_quotation.search</field>
            <field name="model">prakruti.sales_quotation</field>
            <field name="arch" type="xml">
                <search string="Product Wise Search">
                    <field name="product_id"/>
                    <field name='quotation_no'/>
                    <field name='inquiry_no'/>
                    <field name='customer_id'/>
                    <field name="state"/>
                    <field name='type_of_gst'/>
                </search>
            </field>
        </record>

        
        <!-- Tree view of Prakruti sales quotation Information -->
        <record model="ir.ui.view" id="view_prakruti_sales_quotation_tree">
            <field name="name">Sales Quotation</field>
            <field name="model">prakruti.sales_quotation</field>
            <field name="arch" type="xml">
                <tree string="Sales Quotation" colors="orange:state =='partially_confirmed';brown:state =='production_slip_confirmed';red:state =='rejected';green:state =='confirm';violet:state =='partial_order';" create= "false">
                    <field name='quotation_no'/>
                    <field name='quotation_date'/>
                    <field name='inquiry_no'/>
                    <field name='customer_id'/>
                    <field name="state"/>
                </tree>
            </field>
        </record>   
        
     <!--     Form view for Sales Quotation     -->
     <record model="ir.ui.view" id="view_prakruti_sales_quotation_form">
        <field name="name">Sales Quotation</field>
        <field name="model">prakruti.sales_quotation</field>
        <field name="arch" type="xml">
        <form string="Sales Quotation" create= "false">
            <header position="inside"> 
                <button name="action_to_order" string="To Order" type="object" attrs="{'invisible':[('state', 'not in', ('quotation'))]}"/>
                <field name='state' widget='statusbar'/>
            </header>
            <group>
                <field name='auto_no' invisible="True"/>                                 
                <field name='req_no_control_id' invisible="True"/>
                <field name='qo_no' invisible="True"/>
            </group>
            <group string = 'Sales Quotation'/>
            <button name="revise_quotation" string="Is Revision Required ?" type="object" class="oe_highlight" attrs="{'invisible':['|',('state', 'not in',('quotation')),('revise_status', 'in', ('revise_quotation'))]}"/>                                         
            <button name="revise_done" string="Revise Done" type="object" class="oe_highlight" attrs="{'invisible':[('revise_status', 'not in', ('revise_quotation'))]}"/>
            <field name='revise_status' widget='statusbar' attrs="{'invisible':[('is_revise', '=', False)]}"/>
            <group colspan="2" cols="6">
                <field name ="is_revise" attrs="{'invisible':[('is_revise', '=', False)]}"/>
                <field name ="revise_no" attrs="{'invisible':[('is_revise', '=', False)]}"/>
                <field name="revise_flag" invisible="True"/>
            </group>
            <group colspan="4" col="4">
                <field name ="inquiry_no"/>
                <field name ="inquiry_date" readonly="True"/>
                <field name ="quotation_date" attrs="{'readonly':[('state', 'not in', ('quotation'))]}"/>
                <field name ="quotation_no" />
                <field name ="customer_id" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" readonly="True"/>
                <field name='type_of_gst'/>
                <field name ="product_type_id" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" readonly= "True"/>
                <field name='shipping_id' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'not in', ('quotation'))]}"/>
                <field name='billing_id' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'not in', ('quotation'))]}"/>
                <field name='quotation_id'  options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                <field name='company_address' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                <field name='requested_id'  options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" invisible="True"/>
            </group>
            <notebook colspan="2">
                <page string='Product Details'>
                    <field name='grid_id' attrs="{'readonly':[('state', 'not in', ('quotation')),('revise_status', 'not in', ('revise_quotation'))]}" />
                    <group name="total_details"  string='Total'>
                        <group class="oe_subtotal_footer oe_left">
                            <field name='total_taxable_value' invisible="True"/>
                            <field name='total_amount' invisible="True"/>
                            <field name='total_no_of_products' invisible="True"/>
                            <field name='proportionate_amount_to_products' invisible="True"/>
                            <field name='freight_charges'/>
                            <field name='loading_and_packing_charges'/>
                            <field name='insurance_charges'/>
                            <field name='other_charges'/>
                            <field name='all_additional_charges' invisible="True"/>
                            <field name='total_amount_before_tax'/>
                            <field name='total_cgst_amount' invisible="True"/>
                            <field name='total_sgst_amount' invisible="True"/>
                            <field name='total_igst_amount' invisible="True"/>
                            <field name='total_gst_amount' />
                            <field name='total_amount_after_tax'/>
                            <field name="total_gst_in_words" invisible="True"/>
                            <field name="grand_total_in_words" invisible="True"/>
                        </group>
                    </group>
                </page>
                <page string='Other details'>
                    <group colspan="2" cols="6">
                        <field name='reference_no' attrs="{'readonly':[('state', 'not in', ('quotation'))]}"/>
                        <field name='reference_date' attrs="{'readonly':[('state', 'not in', ('quotation'))]}"/>
                        <field name='terms' attrs="{'readonly':[('state', 'not in', ('quotation'))]}"/>
                        <field name='remarks' attrs="{'readonly':[('state', 'not in', ('quotation'))]}"/>
                        <field name='revision_no' attrs="{'readonly':[('state', 'not in', ('quotation'))]}"/>
                        <field name ="revise_remarks" placeholder='Enter Revise Remarks Here...' attrs="{'invisible': [('is_revise', '=', False)]}"/>
                        <field name ="revise_id" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'invisible': [('is_revise', '=', False)]}"/>
                        <field name ="revise_remarks_update" />
                    </group>
                </page>
            </notebook>
        </form>
    </field>
</record>
        
    <!--  Tree view for Sales Quotation Line     -->
     <record model="ir.ui.view" id="view_prakruti_sales_quotation_line_tree">
         <field name="name">prakruti.sales_quotation_line.tree</field>
         <field name="model">prakruti.sales_quotation_line</field>
         <field name="arch" type="xml">
             <tree string="Sales Quotation Item " editable='bottom' create= "false" delete= "false">
                    <field name='product_id' on_change="onchange_product(product_id)" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" domain="[ ('group_ref','=',parent.product_type_id)]" attrs="{'readonly':['|',('revise_quotation_line', '=',2),('revise_quotation_line', '=', 2)]}"/>
                    <field name="description" attrs="{'readonly':[('revise_quotation_line', '=', 2)]}"/>
                    <field name='uom_id' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('revise_quotation_line', '=', 2)]}"/>
                    <field name='specification_id' domain="[('product_id','=',product_id)]" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('revise_quotation_line', '=', 2)]}"/>
                    <field name='hsn_code' attrs="{'readonly':[('revise_quotation_line', '=', 2)]}"/>
                    <field name='quantity' attrs="{'readonly':[('revise_quotation_line', '=', 2)]}"/><!-- OLD ENTRY -->
                    <field name='unit_price' attrs="{'readonly':[('revise_quotation_line', '=', 2)]}"/><!-- OLD ENTRY -->
                    <field name='amount'/>
                    <field name='discount' attrs="{'readonly':[('revise_quotation_line', '=', 2)]}"/>
                    <field name='taxable_value'/>
                    <field name='proportionate_amount_to_products' invisible="True"/>
                    <field name='taxable_value_with_charges'/>
                    <field name='gst_rate' invisible="True"/>
                    <field name='cgst_id' attrs="{'readonly':[('revise_quotation_line', '=', 2)]}" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name='cgst_value' invisible="True"/>
                    <field name='cgst_amount'/>
                    <field name='sgst_id' attrs="{'readonly':[('revise_quotation_line', '=', 2)]}" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name='sgst_value' invisible="True"/>
                    <field name='sgst_amount'/>
                    <field name='igst_id' attrs="{'readonly':[('revise_quotation_line', '=', 2)]}" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name='igst_value' invisible="True"/>
                    <field name='igst_amount'/>
                    <field name='total'/>
                    <field name='remarks' attrs="{'readonly':[('revise_quotation_line', '=', 2)]}"/>
                    <field name='inquiry_line_id' invisible="True"/>
                    <field name="revise_quotation_line" invisible="1" />
                    <field name="sale_price" invisible="1" />
             </tree>
         </field>
     </record>
     
     <!--     Pivot for Sales Quotation  -->
     <record model="ir.ui.view" id="view_prakruti_sales_quotation_pivot">
            <field name="name">prakruti.sales_quotation.pivot</field>
            <field name="model">prakruti.sales_quotation</field>
            <field name="arch" type="xml">
                <pivot string="Sales Quotation" display_quantity="True">
                    <field name="customer_id" type="row"/>
                    <field name="quotation_id"/>
                </pivot>
            </field>
        </record>
        
        <!-- Action for purchase Information -->
        <record model="ir.actions.act_window" id="prakruti_sales_quotation_action">
            <field name="name">Sales Quotation</field>
            <field name="res_model">prakruti.sales_quotation</field>
            <field name="view_type">form</field>
         <field name="domain">[('revise_flag','=',0)]</field>
            <field name="view_mode">tree,form,pivot</field>
        </record>
           
        <menuitem name="Sales Quotation" 
                  id="prakruti_sales_quotation_menu"
                  action="prakruti_sales_quotation_action" 
                  sequence="2"
                  parent="prakruti_sales_main_sub_menu"
                  groups="prakruti.group_prakruti_sales_quotation_read_only,prakruti.group_prakruti_sales_quotation_edit,prakruti.group_prakruti_sales_quotation_create,prakruti.group_prakruti_sales_quotation_delete"/>
        
</data>
</openerp>
