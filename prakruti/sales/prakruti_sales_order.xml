<?xml version="1.0" encoding="utf-8"?>
<openerp>
 <data>
     
        <!-- Search View for Sales Order -->
        <record model="ir.ui.view" id="view_prakruti_sales_order_search">
            <field name="name">prakruti.sales_order.search</field>
            <field name="model">prakruti.sales_order</field>
            <field name="arch" type="xml">
                <search string="Product Wise Search">
                    <field name="product_id"/>
                    <field name='order_no'/>
                    <field name='quotation_no'/>
                    <field name='inquiry_no'/>
                    <field name='customer_id'/>
                    <field name="state"/>
                </search>
            </field>
        </record>
        
        <!-- Tree View for Sales Order         -->
        <record model="ir.ui.view" id="view_prakruti_sales_order_tree">
            <field name="name">prakruti.sales_order.tree</field>
            <field name="model">prakruti.sales_order</field>
            <field name="arch" type="xml">
                <tree string="Sales Order Information" colors="orange:state =='partially_confirmed';brown:state =='production_slip_confirmed';red:state =='rejected';green:state =='confirm';violet:state =='partial_order';" create= "false">
                    <field name='order_no'/>
                    <field name='order_date'/>
                    <field name='quotation_no'/>
                    <field name='quotation_date'/>
                    <field name='inquiry_no'/>
                    <field name='customer_id'/>
                    <field name="state"/>
                </tree>
            </field>
        </record>
        
        
        <record model="ir.ui.view" id="view_prakruti_sales_order_form">
            <field name="name">prakruti.sales_order.form</field>
            <field name="model">prakruti.sales_order</field>
            <field name="arch" type="xml">
                <form string="Sales Order Information" create= "false">
                <header position="inside">
                    <button name= 'action_reject' string= "Rejected" type="object" attrs="{'invisible':[('state', 'in', ('confirm','rejected','short_close'))]}" groups="prakruti.group_sales_rejection_management"/>
                    <button name= 'order_to_slip' string="Production Slip Issue" type="object" attrs="{'invisible':[('state', 'in', ('rejected','slip_request','production_slip_confirmed','confirm','without_qc_invoice','extra_confirm','extra_without_qc_invoice','short_close'))]}"/>
                    <button name= 'action_performa_invoice' string="Proforma Invoice" type="object" attrs="{'invisible':[('state', 'in', ('rejected','slip_request','partially_confirmed','short_close'))]}"/>
                    <button name="short_close_order" string="Short Close" type="object" class="oe_highlight" attrs="{'invisible':[('state', 'in', ('partial_order','confirm','without_qc_partially_confirmed','without_qc_invoice','extra_partial_order','extra_confirm','extra_without_qc_partially_confirmed','extra_without_qc_invoice','rejected','short_close'))]}"/>
                    <field name='state' widget='statusbar'/> 
                </header>
                <group colspan="2" cols="6">
                    <field name='ord_no' invisible="True"/>
                    <field name='auto_no' invisible="True"/>
                    <field name='req_no_control_id1' invisible="True"/>
                    <field name='countflag' invisible='True'/>
                    <field name='balance_line' invisible='True'/>
                    <field name='amount_flag' invisible="True"/>
                    <field name='slip_no' invisible="True"/> 
                </group>
                <group string = 'Sales Order'/>
                    <button name="revise_order" string="Is Revision Required ?" type="object" class="oe_highlight" attrs="{'invisible':['|',('state', 'not in',('order')),('revise_status', 'in', ('revise_order'))]}"/>                                         
                    <button name="revise_done" string="Revise Done" type="object" class="oe_highlight" attrs="{'invisible':[('revise_status', 'not in', ('revise_order'))]}"/>
                    <field name='revise_status' widget='statusbar' attrs="{'invisible':[('is_revise', '=', False)]}"/>
                    <group colspan="2" cols="6">
                        <field name ="is_revise" attrs="{'invisible':[('is_revise', '=', False)]}"/>
                        <field name ="revise_no" attrs="{'invisible':[('is_revise', '=', False)]}"/>
                        <field name="revise_flag" invisible="True"/>
                    </group>
                    <group colspan="4" col="4">
                        <field name='order_no'/>
                        <field name='order_date' attrs="{'readonly':[('state', 'in', ('slip_request','confirm'))]}"/>
                        <field name='inquiry_no'/>
                        <field name='inquiry_date' readonly="True"/>
                        <field name='quotation_no'/>
                        <field name='quotation_date' readonly="True"/>
                        <field name='customer_id' domain="[('customer','=',True)]"  options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" readonly="True"/>
                        <field name='product_type_id' domain="[('id','=',(5,6))]" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" readonly="True"/>
                        <field name='shipping_id'   options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'in', ('slip_request','confirm'))]}"/>
                        <field name='billing_id'  options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'in', ('slip_request','confirm'))]}"/>               
                        <field name='po_no' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'in', ('slip_request','confirm','partially_confirmed','rejected'))]}"/>
                        <field name='order_id'  options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                        <field name='revised_by'/>
                        <field name="company_address" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                        <field name='requested_id'  options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" invisible="True"/>
                        <field name='quotation_id'  options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" invisible="True"/>
                    </group>
                    <notebook>
                        <page string='Product Details'>
                            <field name='grid_id' />
                            <group name="total_details"  string='Total'>
                                <group class="oe_subtotal_footer oe_left">
                                    <field name='total_taxable_value' invisible="True"/>
                                    <field name='total_amount' invisible="True"/>
                                    <field name='total_no_of_products' invisible="True"/>
                                    <field name='proportionate_amount_to_products' invisible="True"/>
                                    <field name='freight_charges'/>
                                    <field name='loading_and_packing_charges'/>
                                    <field name='insurance_charges'/>
                                    <field name='other_charges'/>
                                    <field name='all_additional_charges' invisible="True"/>
                                    <field name='total_amount_before_tax'/>
                                    <field name='total_cgst_amount' invisible="True"/>
                                    <field name='total_sgst_amount' invisible="True"/>
                                    <field name='total_igst_amount' invisible="True"/>
                                    <field name='total_gst_amount' />
                                    <field name='total_amount_after_tax'/>
                                    <field name='grand_total'/>
                                    <button name="calculate_total" string="(update)" type="object" class="oe_edit_only oe_link" attrs="{'invisible':[('state', 'in', ('order','slip_request'))]}"/><newline/>
                                </group>
                                <group>
                                    <field name="total_gst_in_words" invisible="True"/>
                                    <field name="grand_total_in_words" invisible="True"/>
                                </group>                                        
                            </group>
                        </page>
                        <page string='Other details'>
                            <group colspan="2" cols="4" >
                                <field name='revision_no' attrs="{'readonly':[('state', 'not in', ('confirm'))]}"/>
                                <field name='reference_no' attrs="{'readonly':[('state', 'not in', ('confirm'))]}"/>
                                <field name='reference_date' attrs="{'readonly':[('state', 'not in', ('confirm'))]}"/>
                                <field name='terms' attrs="{'readonly':[('state', 'in', ('confirm'))]}"/>
                                <field name='remarks' attrs="{'readonly':[('state', 'in', ('confirm'))]}"/>
                                <field name='short_close_remarks' attrs="{'readonly':[('state', 'in', ('reject','short_close'))]}"/>
                            </group>
                            <group string="Payment Details" autofocus="autofocus">
                                <group colspan="2" col="6">
                                    <field name='any_adv_payment'/>
                                    <field name='advance_payment_type' attrs="{'invisible':[('any_adv_payment', '!=', 'yes')]}"/>
                                    <group string="Cash Details" attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cash'))]}">
                                        <field name='cash_amount' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cash'))]}"/>
                                        <field name='cash_remarks' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cash'))]}"/>
                                    </group>
                                    <group string="Cheque Details" attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cheque'))]}">
                                        <field name='cheque_amount' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cheque'))]}"/>
                                        <field name='cheque_no' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cheque'))]}"/>
                                        <field name='cheque_remarks' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cheque'))]}"/>
                                    </group>
                                    <group string="Draft Details" attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('demand_draft'))]}">
                                        <field name='draft_amount' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('demand_draft'))]}"/>
                                        <field name='draft_no' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('demand_draft'))]}"/>
                                        <field name='draft_remarks' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('demand_draft'))]}"/>
                                    </group>
                                </group>
                            </group>
                            <group>
                                <field name ="revise_remarks" placeholder='Enter Revise Remarks Here...' attrs="{'invisible': [('is_revise', '=', False)]}"/>
                                <field name ="revise_id" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'invisible': [('is_revise', '=', False)]}"/>
                                <field name ="revise_remarks_update" />
                            </group>
                        </page>
                </notebook>
            </form>
        </field>
    </record>
        
    <!--  Tree view for Sales Order Line     -->
     <record model="ir.ui.view" id="view_prakruti_sales_order_item_tree">
         <field name="name">prakruti.sales_order_item.tree</field>
         <field name="model">prakruti.sales_order_item</field>
         <field name="arch" type="xml">
             <tree string="Sales Order Item " editable='bottom' create= "false" delete= "false" >
                    <field name='product_id' on_change="onchange_product(product_id)" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" domain="[('group_ref','=',parent.product_type_id)]"  attrs="{'readonly':[('revise_order_line', 'in', (0,2))]}"/>
                    <field name="description" attrs="{'readonly':[('revise_order_line', 'in', (0,2))]}"/>
                    <field name='uom_id' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('revise_order_line', 'in', (0,2))]}"/>
                    <field name="specification_id" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" domain="['&amp;',('product_id','=',product_id),'|',('specification_sale_status','=',True),('common_specification','=',True)]" attrs="{'readonly':[('revise_order_line', '=', 2)]}"/>
                    <field name='hsn_code' attrs="{'readonly':[('revise_order_line', '=', 2)]}"/>
                    <field name='quantity' attrs="{'readonly':[('revise_order_line', 'in', (0,2))]}"/>
                    <field name='unit_price' attrs="{'readonly':[('revise_order_line', '=', 2)]}"/>
                    <field name='amount'/>
                    <field name='discount' attrs="{'readonly':[('revise_order_line', '=', 2)]}"/>
                    <field name='taxable_value'/>
                    <field name='proportionate_amount_to_products' invisible="True"/>
                    <field name='taxable_value_with_charges'/>
                    <field name='gst_rate' invisible="True"/>
                    <field name='cgst_id' attrs="{'readonly':[('revise_order_line', '=', 2)]}" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name='cgst_value' invisible="True"/>
                    <field name='cgst_amount'/>
                    <field name='sgst_id' attrs="{'readonly':[('revise_order_line', '=', 2)]}" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name='sgst_value' invisible="True"/>
                    <field name='sgst_amount'/>
                    <field name='igst_id' attrs="{'readonly':[('revise_order_line', '=', 2)]}" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name='igst_value' invisible="True"/>
                    <field name='igst_amount'/>
                    <field name='total_scheduled_qty' />                                    
                    <field name='previous_scheduled_qty' invisible="True"/>                                    
                    <field name='total_dispatched_qty' />                                    
                    <field name='previous_dispatched_qty' invisible="True"/>
                    <field name='req_date' attrs="{'readonly':[('revise_order_line', '=', 2)]}"/>
                    <field name='scheduled_date' />
                    <field name='scheduled_qty' />
                    <field name='balance_qty' />
                    <field name='total'/>
                    <field name='remarks' />                                
                    <field name='dispatched_qty' invisible="True"/>
                    <field name='accepted_qty' invisible="True"/>                                            
                    <field name='remaining_dispatched_qty' invisible="True"/>
                    <field name='status' invisible="True"/>  
                    <field name='inquiry_line_id' invisible="True"/>
                    <field name='revise_order_line' invisible="True"/> 
                    <field name='sale_price' invisible="True"/> 
             </tree>
         </field>
     </record>
        
        <!--Pivot view for Sales Order  -->
        <record model="ir.ui.view" id="view_prakruti_sales_order_pivot">
            <field name="name">prakruti.sales_order.pivot</field>
            <field name="model">prakruti.sales_order</field>
            <field name="arch" type="xml">
                <pivot string="Sales Order" display_quantity="True">
                    <field name="customer_id" type="row"/>
                    <field name="order_id"/>
                    <field name='state' />
                </pivot>
            </field>
        </record>
        
        
        <!--Graph view for Sales Order  -->
        <record model="ir.ui.view" id="prakruti_sales_order_graph">
            <field name="name">prakruti.sales_order.graph</field>
            <field name="model">prakruti.sales_order</field>
            <field name="arch" type="xml">
                <graph string="Sales Order" type="bar" >
                    <field name="order_no" />
                    <field name="customer_id" type="measure"/>
                </graph>
            </field>
        </record>
        <record model="ir.actions.act_window" id="prakruti_sales_order_action">
            <field name="name">Sales Order</field>
            <field name="res_model">prakruti.sales_order</field>
            <field name="view_type">form</field>
            <field name="domain">[('revise_flag','=',0)]</field>
            <field name="view_mode">tree,form,pivot,graph</field>
        </record>
        
        
        <menuitem name="Sales Order" 
                  id="prakruti_sales_order_menu"
                  action="prakruti_sales_order_action" sequence="3"
                  parent="prakruti_sales_main_sub_menu" 
                  groups="prakruti.group_prakruti_sales_order_read_only,prakruti.group_prakruti_sales_order_edit,prakruti.group_prakruti_sales_order_create,prakruti.group_prakruti_sales_order_delete"/>
     

</data>
</openerp>
