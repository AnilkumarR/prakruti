<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        
        <!-- Search view for Bill Of Material         -->
        <record model="ir.ui.view" id="view_prakruti_bill_of_material_search">
            <field name="name">prakruti.bill_of_material.search</field>
            <field name="model">prakruti.bill_of_material</field>
            <field name="arch" type="xml">
                <search string="Product Wise Search">
                    <field name= 'company_id' />
                    <field name ="subplant_id"/>
                    <field name ='batch_id' />
                    <field name ='date'/>
                    <field name ='state'/>
                </search>
            </field>
        </record>
    <!-- Tree view for Bill Of Material -->
        <record model="ir.ui.view" id="view_prakruti_bill_of_material_tree">
            <field name="name">Extraction BOM</field>
            <field name="model">prakruti.bill_of_material</field>
            <field name="arch" type="xml">
                <tree string="Bill Of Material">
                    <field name= 'company_id' />
                    <field name ="subplant_id"/>
                    <field name ='batch_id' />
                    <field name ='date'/>
                    <field name ='state'/>
                    <field name ="is_duplicate"/>
                </tree>
            </field>
        </record>  

        <!--Form view for Bill Of Material  -->
        <record model="ir.ui.view" id="view_prakruti_bill_of_material_form">
            <field name="name">Extraction BOM</field>
            <field name="model">prakruti.bill_of_material</field>
            <field name="arch" type="xml">
                <form string="Extraction BOM">
                    <header>
                        <field name='state' widget='statusbar'/>
                    </header>
                    <footer>
                        <button name ='request_to_stores' string="Request" type="object" class="oe_highlight" attrs="{'invisible':[('state', 'not in', ('draft'))]}"/>
                        <button name ='request_to_stores_for_extra_issue' string="Issue Extra Raw Material" type="object" class="oe_highlight" attrs="{'invisible':[('state', 'in', ('draft','sent_stores','extra_issue'))]}"/>
                        <button name ='return_to_stores' string="Return to issue" type="object" class="oe_highlight" attrs="{'invisible':[('state', 'in', ('draft','sent_stores'))]}"/>
                        <button name='duplicate_bom' string="Duplicate" type="object" class="oe_highlight" attrs="{'invisible':[('is_duplicate', '=', True)]}"/>
                    </footer>
                    <group>     
                        <field name ="existing_batch_no" invisible="True"/>                             
                        <field name ="readonly_flag" invisible="True"/>                             
                        <field name ="duplicate_flag" invisible="True"/>                            
                        <field name ="flag_display_product" invisible="True"/>                             
                        <field name ="flag_delete_product" invisible="True"/>
                    </group>
                    <group string="Extraction BOM" colspan="2" col="6">
                        <field name ="is_duplicate"/>
                        <field name= 'company_id' />
                        <field name ="subplant_id"   options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" domain="[('plant_type','=','extraction')]" style="color: green; font-weight: bold;" attrs="{'readonly':[('readonly_flag', '=', 1)]}"/>
                        <field name ='batch_id' on_change="onchange_batch_id(batch_id)" domain="['&amp;',('plant_type','=','extraction'),('subplant_id','=',subplant_id)]" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('readonly_flag', '=', 1)]}"/>
                        <field name ='std_batch_size_id' domain="[ ('subplant_id','=',subplant_id)]" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('readonly_flag', '=', 1)]}"/>
                        <field name ='actual_batch_size' attrs="{'readonly':[('readonly_flag', '=', 1)]}"/>
                        <field name ="date" attrs="{'readonly':[('readonly_flag', '=', 1)]}"/>
                        <field name ="assay_per" attrs="{'readonly':[('readonly_flag', '=', 1)]}"/>
                        <field name ='label_claim' attrs="{'readonly':[('readonly_flag', '=', 1)]}"/>
                        <field name ='dept_id' attrs="{'readonly':[('readonly_flag', '=', 1)]}" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    </group>
                    <button name="action_list_products"  string="List" type="object" attrs="{'invisible':[('flag_display_product','=',1),('flag_delete_product','=',0)]}"/>
                    <button name="action_delete_products"  string="Delete" type="object" attrs="{'invisible':[('flag_delete_product','=',1),('flag_display_product','=',0)]}"/>
                    <notebook>
                        <page string='Product Details'>
                            <button name="action_extraction_product_id"  string="Add" type="object" />
                            <field name='grid_id'/>
                        </page> 
                        <page  string="Product Wise GRN List">
                            <field name='grn_line'>
                                <tree string="Product Wise GRN List" editable='bottom' create="false">
                                    <field name="product_id" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                                    <field name="grn_id" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                                    <field name="received_qty"/>
                                    <field name="packing_style"/>
                                    <field name='packing_per_qty'/>
                                    <field name="extra_issued_packing" />
                                    <field name='issued_qty'/>
                                    <field name='extra_issued_qty'/>
                                    <field name="remarks" />
                                </tree>
                            </field>
                        </page>
                        <page string='Other Details'>
                            <group string = 'Other Information'/>
                            <group colspan="2" col="6">
                                <field name= "material_issued_by"  options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                                <field name= 'material_checked_by'  options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                                <field name= 'material_recieved_by'  options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                                <field name= 'material_requested_by'  options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                                <field name= "mrn_no"/>
                                <field name= 'mrn_date_time' />
                                <field name ="revise_remarks_update" readonly="True"/> 
                            </group>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>

        
        <!-- Tree view for Bill Of Material         -->
        <record model="ir.ui.view" id="view_prakruti_bill_of_material_line_tree">
            <field name="name">Bill Of Material</field>
            <field name="model">prakruti.bill_of_material_line</field>
            <field name="arch" type="xml">
                <tree  editable='bottom' create='false'>
                    <field name ="id" invisible="True"/>
                    <field name='material_id' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"  on_change="onchange_material_id(material_id)" attrs="{'readonly':[('readonly_grid', '=', 1)]}"/>
                    <field name='description' attrs="{'readonly':[('readonly_grid', '=', 1)]}"/>
                    <field name='uom_id' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('readonly_grid', '=', 1)]}"/>
                    <field name='std_qty'  />
                    <field name='actual_qty' attrs="{'readonly':[('readonly_grid', '=', 1)]}"/>
                    <field name='extra_qty' attrs="{'readonly':[('extra_flag', '=', 0)]}"/>
                    <field name='grn_no' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" invisible="1"/>
                    <field name='grn_list' />
                    <field name='ar_no' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" domain="[ ('product_id','=',material_id)]"/>
                    <field name='issued_qty' />
                    <field name='extra_issued_qty' />
                    <field name='qty_returned' />
                    <field name="remarks" />
                    <field name='extra_flag' invisible="True"/>
                    <field name='issue_common_id' invisible="True"/>
                    <field name='readonly_grid' invisible="True"/>
                </tree>
            </field>
        </record>  
        
        <!--Pivot for Bill Of Material          -->
        <record model="ir.ui.view" id="view_prakruti_bill_of_material_pivot">
            <field name="name">prakruti.bill_of_material.pivot</field>
            <field name="model">prakruti.bill_of_material</field>
            <field name="arch" type="xml">
                <pivot string=" Extraction BOM" display_quantity="True">
                    <field name="subplant_id" type="row"/>
                    <field name="batch_id"/>
                    <field name ='state'/>
                </pivot>
            </field>
        </record> 

        <!--Action for Bill Of Material  -->
        <record model="ir.actions.act_window" id="prakruti_bill_of_material_action">
            <field name="name">Extraction BOM</field>
            <field name="res_model">prakruti.bill_of_material</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,pivot</field>
        </record>
        
       
         <menuitem name="Production BOM" 
                   id="prakruti_production_planning_menu" 
                   parent="prakruti_production_slip_main_menu"
                   sequence="3" />
         
        <menuitem  name="Extraction BOM" 
                   id="prakruti_bill_of_material_menu" 
                   action="prakruti_bill_of_material_action" 
                   sequence='1'
                   parent="prakruti_production_planning_menu"
                   groups="group_prakruti_bill_of_material_read_only,group_prakruti_bill_of_material_edit,group_prakruti_bill_of_material_create,group_prakruti_bill_of_material_delete"/>
        
    </data>
</openerp>