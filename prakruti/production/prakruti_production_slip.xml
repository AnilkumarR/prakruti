<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <!--   Search View fpr Production SLip       -->
        <record model="ir.ui.view" id="view_prakruti_production_slip_search">
            <field name="name">prakruti.production_slip.search</field>
            <field name="model">prakruti.production_slip</field>
            <field name="arch" type="xml">
                <search string="Product Wise Search">
                    <field name="product_id"/>
                    <field name="slip_no"/>
                    <field name='order_no'/>
                    <field name='order_date'/>
                    <field name='customer_id' />
                    <field name='state'/>
                    <field name="slip_type" />
                </search>
            </field>
        </record>
        
        <!--  Tree View  for Production SLip        -->
        <record model="ir.ui.view" id="view_prakruti_production_slip_tree">
            <field name="name">Production Slip Tree</field>
            <field name="model">prakruti.production_slip</field>
            <field name="arch" type="xml">
                <tree string=" Production Slip" colors="orange:state =='partially_confirmed';brown:state =='production_slip_confirmed';red:state =='rejected';green:state =='confirm';violet:state =='partial_order';" >
                    <field name="slip_no"/>
                    <field name='slip_date'/>
                    <field name='order_no'/>
                    <field name='order_date'/>
                    <field name='customer_id' />
                    <field name='state'/>
                    <field name="slip_type" />
                </tree>
            </field>
        </record>
        
      <!--  Form View for Production SLip         -->
        <record model="ir.ui.view" id="view_prakruti_production_slip_form">
            <field name="name">Production Slip Form</field>
            <field name="model">prakruti.production_slip</field>
            <field name="arch" type="xml">
                <form string="Production Slip" >
                    <header>
                        <button name="to_salesorder" string="Set to Confirm Order" type="object" attrs="{'invisible':['|',('state','in',('production_slip_confirmed','partially_confirmed','rejected','partially_invoiced','invoice','partial_order','confirm','without_qc_partially_confirmed','without_qc_invoice','extra_partial_order','extra_confirm','extra_without_qc_partially_confirmed','extra_without_qc_invoice','short_close')),('slip_type','in',('buffer'))]}"/> 
                        <button name= 'action_reject' string= "Rejected" type="object" attrs="{'invisible':['|',('state','in',('rejected','production_slip_confirmed','partially_confirmed','confirm','partially_invoiced','invoice','extra_partial_order','extra_confirm','extra_without_qc_partially_confirmed','extra_without_qc_invoice','short_close')),('slip_type','in',('buffer'))]}" groups="prakruti.group_sales_rejection_management"/>
                        <field name='state' widget='statusbar' attrs="{'invisible':[('slip_type','in',('buffer'))]}"/>
                        <field name='buffer_status' widget='statusbar' attrs="{'invisible':[('slip_type','in',('based_on_order'))]}"/>
                    </header>
                    <group>
                        <button name="revise_production_slip" string="Is Revision Required ?" type="object" class="oe_highlight" attrs="{'invisible':['|',('state', 'not in',('slip_request')),('revise_status', 'in', ('revise_production_slip'))]}"/>                                         
                        <button name="revise_done" string="Revise Done" type="object" class="oe_highlight" attrs="{'invisible':[('revise_status', 'not in', ('revise_production_slip'))]}"/>
                        <field name='revise_status' widget='statusbar' attrs="{'invisible':[('is_revise', '=', False)]}"/>
                    </group>
                    <group colspan="4" col="4">
                        <field name="slip_type" />
                        <field name='product_type_id' domain = "[('id','in',(5,6))]" attrs="{'invisible':[('slip_type','not in',('buffer'))]}" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                        <field name='slip_no' />
                        <field name='slip_date' />
                        <field name='order_no' attrs="{'invisible':[('slip_type','in',('buffer'))]}"/>
                        <field name='order_date' attrs="{'invisible':[('slip_type','in',('buffer'))]}"/>
                        <field name='company_id' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" />
                        <field name='customer_id' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'invisible':[('slip_type','in',('buffer'))]}"/>
                        <field name ="is_revise" attrs="{'invisible':[('is_revise', '=', False)]}"/>
                        <field name ="revise_no" attrs="{'invisible':[('is_revise', '=', False)]}"/>
                        <field name ="po_no" readonly="True"/>
                    </group>
                    <group>
                        <field name="revise_flag" invisible="True"/>
                        <field name='order_id'   invisible="True"/>
                        <field name='requested_id'   invisible="True"/>
                        <field name='quotation_id'   invisible="True"/>
                        <field name='sl_no' invisible="True"/>
                        <field name='auto_no' invisible="True"/>
                        <field name='req_no_control_id' invisible="True"/>
                        <field name='quotation_no' invisible="True"/>
                        <field name='quotation_date' invisible="True"/>
                        <field name='inquiry_date' invisible="True"/>
                        <field name='inquiry_no' invisible="True"/>
                        <field name='billing_id' invisible="True"/>
                        <field name='remarks' invisible="True"/>
                        <field name='terms' invisible="True"/>
                        <field name='all_send_to_request' invisible="True"/>
                        <field name='all_send_to_planning' invisible="True"/>
                        <field name='buffer_status_update' invisible="True"/>
                    </group>
                    <notebook>
                        <page string="Product Info.">
                            <button name="check_stock" string="Check Stock" type="object" />
                            <button name="raise_planning" string="Production Planning" type="object" attrs="{'invisible':['|',('all_send_to_planning','=',1),('slip_type','in',('buffer'))]}"/>              
                            <button name="raise_bmr_requisition" string="Send BMR Request" type="object" attrs="{'invisible':[('all_send_to_request','=',1)]}"/>
                            <field name='grid_id' widget= 'one2many_list' attrs="{'readonly':[('state', 'not in', ('slip_request')),('revise_status', 'not in', ('revise_production_slip'))]}">
                                <tree editable='bottom' >
                                    <field name="slip_type" invisible= 'True'/>
                                    <field name="product_id" domain = "[('group_ref','=',parent.product_type_id)]" on_change="onchange_product(product_id)" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('revise_slip_line', '=', 2)]}" />
                                    <field name="description"  attrs="{'readonly':[('revise_slip_line', '=', 2)]}"/> 
                                    <field name="uom_id" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"  attrs="{'readonly':[('revise_slip_line', '=', 2)]}"/>
                                    <field name="specification_id" domain="[('product_id','=',product_id)]" options="{'no_create':True,'no_open':True,'no_create_edit':True}" attrs="{'readonly':[('revise_slip_line', '=', 2)]}"/>
                                    <field name="store_qty" />                       
                                    <field name='ordered_qty' readonly="True"/>    
                                    <field name="quantity" readonly="True"/>                        
                                    <field name='total_scheduled_qty' attrs="{'invisible':[('slip_type','in',('buffer'))]}"/>                                    
                                    <field name='total_dispatched_qty' attrs="{'invisible':[('slip_type','in',('buffer'))]}"/>    
                                    <field name="req_date" attrs="{'invisible':[('slip_type','in',('buffer'))]}"/>
                                    <field name="scheduled_date" attrs="{'readonly':[('revise_slip_line', '=', 2)]}"/>
                                    <field name="scheduled_qty" attrs="{'readonly':[('revise_slip_line', '=', 2)]}"/>                                        
                                    <field name='balance_qty' attrs="{'invisible':[('slip_type','in',('buffer'))]}"/>
                                    <field name="bmr_status" />
                                    <field name="planning_status" attrs="{'invisible':[('slip_type','in',('buffer'))]}"/>
                                    <field name="planning_done" attrs="{'invisible':[('slip_type','in',('buffer'))]}"/>  
                                    <field name="remarks" attrs="{'readonly':[('revise_slip_line', '=', 2)]}"/>
                                    <field name="bmr_flag" invisible="True"/>
                                    <field name="planning_flag" invisible="True"/>
                                    <field name="total" invisible= 'True'/>
                                    <field name="total_ordered_qty" invisible= 'True'/>
                                    <field name="so_line_grid_id" invisible= 'True'/>
                                    <field name="unit_price" invisible= 'True'/>
                                    <field name="revise_slip_line" invisible= 'True'/>
                                </tree>
                            </field>
                        </page>
                        <page string="Remarks">
                            <group colspan="2" cols="4">
                                <field name='reference_no' attrs="{'readonly':[('state','in',('production_slip_confirmed','partially_confirmed','confirm','rejected'))]}"/>
                                <field name="remarks" attrs="{'readonly':[('state','in',('production_slip_confirmed','partially_confirmed','confirm','rejected'))]}"/>
                                <field name ="revise_remarks" placeholder='Enter Revise Remarks Here...' attrs="{'invisible': [('is_revise', '=', False)]}"/>
                                <field name ="revise_id" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'invisible': [('is_revise', '=', False)]}"/>
                                <field name ="revise_remarks_update" />
                                <field name='terms' readonly="True"/> 
                                <field name='reference_date' readonly="True"/>
                                <field name='revision_no' readonly="True"/>
                            </group>
                        </page>
                    </notebook>
                </form>
        </field>
    </record>
        
        
     <!--Pivot view for Production SLip          -->
     <record model="ir.ui.view" id="view_prakruti_production_slip_pivot">
            <field name="name">prakruti.production_slip.pivot</field>
            <field name="model">prakruti.production_slip</field>
            <field name="arch" type="xml">
                <pivot string="Production Slip" display_quantity="True">
                    <field name="state" type="row"/>
                    <field name="customer_id"/>
                </pivot>
            </field>
        </record>
        
        
        <!-- Action  for Production SLip         -->
        <record model="ir.actions.act_window" id="prakruti_production_slip_action">
            <field name="name">Production Slip</field>
            <field name="res_model">prakruti.production_slip</field>
            <field name="view_type">form</field>
            <field name="domain">[('revise_flag','=',0)]</field>
            <field name="view_mode">tree,form,pivot</field>
        </record>
        
        
        <menuitem name="Production" 
                  id="prakruti_production_slip_main_menu" 
                  sequence="6" 
                  web_icon="prakruti,static/src/img/icons/mfg.png"/>
        <menuitem name="Production Transaction" 
                  id="prakruti_production_slip_main_sub_menu" 
                  parent="prakruti_production_slip_main_menu" 
                  sequence="1"/>
        <menuitem name="Production Slip" 
                  id="prakruti_production_slip_sub_menu1" 
                  parent="prakruti_production_slip_main_sub_menu" 
                  action="prakruti_production_slip_action" 
                  sequence="1" groups="group_prakruti_production_slip_read_only,group_prakruti_production_slip_edit,group_prakruti_production_slip_create,group_prakruti_production_slip_delete"/>
    
    </data>
</openerp>
