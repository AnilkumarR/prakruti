<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        
        <!--     Search View for Purchase Quotation Analysis-->        
        <record model="ir.ui.view" id="view_purchase_order_quotation_analysis_search">
            <field name="name">Purchase Quotation Analysis</field>
            <field name="model">prakruti.purchase_order_quotation_analysis</field>
            <field name="arch" type="xml">
                <search string="Purchase Quotation Analysis">
                    <field name="product_id"/>
                    <field name='qa_no'/>
                    <field name='qo_no'/>
                    <field name='inq_no'/>
                    <field name="purchase_type"/>
                    <field name='prepared_by'/>
                    <field name="state"/>
                    <field name="quotation_status"/>
                </search>
            </field>
        </record>
        
        <!--     Tree View for Purchase Quotation Analysis-->        
        <record model="ir.ui.view" id="view_purchase_order_quotation_analysis_tree">
            <field name="name">Purchase Quotation Analysis</field>
            <field name="model">prakruti.purchase_order_quotation_analysis</field>
            <field name="arch" type="xml">
                <tree string="Purchase Quotation Analysis" create= "false" colors="green:state =='confirm';blue:state =='short_close';red:state =='reject';">
                    <field name='qa_no'/>
                    <field name='qo_no'/>
                    <field name="order_date"/>
                    <field name='inq_no'/>
                    <field name="purchase_type"/>
                    <field name='prepared_by'/>
                    <field name="state"/>
                    <field name="quotation_status"/>
                </tree>
            </field>
        </record>
        
        <!--     Form View for Purchase Quotation Analysis-->
        <record model="ir.ui.view" id="view_purchase_order_quotation_analysis_form">
            <field name="name">Purchase Quotation Analysis</field>
            <field name="model">prakruti.purchase_order_quotation_analysis</field>
            <field name="arch" type="xml">
                <form string="Purchase Quotation Analysis" create= "false">
                    <header>                        
                        <button name="confirm_to_order" string="To Order" type="object" attrs="{'invisible':[('state', 'in', ('order','confirm','reject','short_close'))]}"/>
                        <field name='state' widget='statusbar'/>
                    </header>
                    <footer>                        
                        <field name='quotation_status' widget='statusbar'/>
                    </footer>
                    <group string = "Purchase Quotation Analysis"/>
                    <button name="revise_quotation_analysis" string="Is Revision Required ?" type="object" class="oe_highlight" attrs="{'invisible':['|',('state', 'not in',('analysis')),('revise_status', 'in', ('revise_quotation_analysis'))]}"/>                                         
                    <button name="revise_done" string="Revise Done" type="object" class="oe_highlight" attrs="{'invisible':[('revise_status', 'not in', ('revise_quotation_analysis'))]}"/>
                    <field name='revise_status' widget='statusbar' attrs="{'invisible':[('is_revise', '=', False)]}"/>
                    <group colspan="2" col="6">
                        <field name ="quotation_no" invisible="True"/>
                        <field name ="auto_no" invisible="True"/>
                        <field name ="req_no_control_id" invisible="True"/>
                        <field name='pr_common_id' invisible="True"/>
                        <field name='pr_request_common_id' invisible="True"/>
                        <field name="revise_flag" invisible="True"/>
                    </group>
                    <group colspan="2" col="6">
                        <field name ="is_revise" attrs="{'invisible':[('is_revise', '=', False)]}"/>
                        <field name ="revise_no" attrs="{'invisible':[('is_revise', '=', False)]}"/>
                    </group>         
                    <group colspan="2" col="6">
                        <field name ="purchase_type" options="{'no_create': True, 'no_open': True}" attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                        <field name='qa_no'/>
                        <field name='qo_no'/>
                        <field name='inq_no'/>
                        <field name='pr_no'/>
                        <field name="order_date" attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                        <field name="requisition_date" attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                        <field name='vendor_id' domain="[ ('supplier','=',True)]" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'in', ('confirm','reject','short_close'))]}"/>
                        <field name='vendor_reference' attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>                        
                        <field name='prepared_by' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" readonly= "True"/>
                        <field name='company_address' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                        <field name='delivery_address' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                        <field name='dispatch_through' attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                        <field name ="categorization" readonly="True"/>
                    </group>
                    <notebook>
                        <page string='Product Details'>
                            <field name='order_line' widget= 'one2many_list' attrs="{'readonly':[('state', 'not in', ('analysis')),('revise_status', 'not in', ('revise_quotation_analysis'))]}"/>
                            <group>
                                <group class="oe_subtotal_footer oe_right">                                        
                                    <field name='total_amount' invisible= '1'/>
                                    <field name='no_of_product' invisible= '1'/>
                                    <field name='proportionate_amount_to_products' invisible="1"/>
                                    <field name='total_taxable_value' invisible="1"/>                                                                                      
                                    <field name='amount_taxed'/>
                                    <field name='packing_charges' attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                                    <field name='frieght_charges_applied' attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                                    <field name='frieght_charges'  attrs="{'invisible':[('frieght_charges_applied', '!=', 'yes')], 'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}" />  
                                    <field name='additional_charges' attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                                    <field name='insurance_charges' attrs="{'readonly':[('state', 'not in', ('quotation'))]}"/>
                                    <field name='total_cgst'/>
                                    <field name='total_sgst'/>
                                    <field name='total_igst'/>
                                    <field name='total_gst'/>
                                    <field name='grand_total'/>                                    
                                    <field name='grand_total_in_words' invisible= '1'/>                                      
                                    <field name='gst_total_in_words' invisible= '1'/>   
                                </group>
                            </group>                                
                        </page>
                        <page string='Other details'>
                            <group colspan="2" col="6">
                                <field name="payment" attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                                <field name='destination' attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                                <field name='other_reference' attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>                                    
                                <field name ="maintanence_manager" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>                                  
                                <field name ="stores_incharge" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                                <field name ="purchase_manager" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                                <field name='terms_of_delivery' attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                                <field name ="plant_manager" attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                                <field name ="to_name" attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                                <field name ="document_no" attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                                <field name ="revision_no" attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                                <field name ="default_pr_date" attrs="{'readonly':[('state', 'in', ('analysis','order','confirm','reject','short_close'))]}"/>
                                <field name='remarks' attrs="{'readonly':[('state', 'in', ('order','confirm','reject','short_close'))]}"/>
                                <field name ="revise_remarks" placeholder='Enter Revise Remarks Here...' attrs="{'invisible': [('is_revise', '=', False)]}"/>
                                <field name ="revise_id" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'invisible': [('is_revise', '=', False)]}"/>
                                <field name ="revise_remarks_update" />
                            </group>
                        </page> 
                  </notebook>
                </form>
            </field>
        </record>
        
        <!--     Tree View for Purchase Quotation Analysis Line-->
        <record model="ir.ui.view" id="view_prakruti_purchase_quotation_analysis_line_tree">
            <field name="name">Purchase Quotation Analysis</field>
            <field name="model">prakruti.purchase_quotation_analysis_line</field>
            <field name="arch" type="xml">
                <tree editable='bottom' create= "false" delete="false">
                    <field name='product_id' on_change="onchange_product_id(product_id)"   options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" domain="[ ('group_ref','=',parent.purchase_type)]" attrs="{'readonly':[('revise_quotation_analysis_line', 'in',(0,2))]}"/>
                    <field name='description' attrs="{'readonly':[('revise_quotation_analysis_line', 'in',(0,2))]}"/>
                    <field name='uom_id' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('revise_quotation_analysis_line', 'in',(0,2))]}"/>                                        
                    <field name='quantity' attrs="{'readonly':[('revise_quotation_analysis_line', 'in',(0,2))]}"/>
                    <field name='unit_price' attrs="{'readonly':[('revise_quotation_analysis_line', '=',(2))]}"/>
                    <field name='total'/>
                    <field name='scheduled_date' attrs="{'readonly':[('revise_quotation_analysis_line', 'in',(0,2))]}"/>
                    <field name='required_date' attrs="{'readonly':[('revise_quotation_analysis_line', '=',(2))]}"/>
                    <field name='hsn_code'  />
                    <field name='discount_rate' attrs="{'readonly':[('revise_quotation_analysis_line', '=',(2))]}"/>
                    <field name='discount_value'/>
                    <field name='taxable_value'/>
                    <field name='taxable_value_after_adding_other'/>
                    <field name='cgst_id' attrs="{'readonly':[('revise_quotation_analysis_line', '=',(2))]}" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name='cgst_rate' invisible="True"/>
                    <field name='cgst_value'/>
                    <field name='sgst_id'  attrs="{'readonly':[('revise_quotation_analysis_line', '=',(2))]}" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name='sgst_rate'  invisible="True"/>
                    <field name='sgst_value'/>
                    <field name='igst_id' attrs="{'readonly':[('revise_quotation_analysis_line', '=',(2))]}" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name='igst_rate'  invisible="True"/>
                    <field name='igst_value'/>
                    <field name='subtotal'/> 
                    <field name='revise_quotation_analysis_line' invisible="True"/>                             
                </tree>
            </field>
        </record>
        
        <!--     Graph View for Purchase Quotation Analysis-->
        <record model="ir.ui.view" id="view_prakruti_purchase_order_quotation_analysis_graph">
            <field name="name">Purchase Quotation Analysis</field>
            <field name="model">prakruti.purchase_order_quotation_analysis</field>
            <field name="arch" type="xml">
                <graph string="Purchase Quotation Analysis" type="bar" >
                    <field name="vendor_id" />
                    <field name="grand_total" type="measure"/>
                </graph>
            </field>
        </record>
        
        <!--     Pivot View for Purchase Quotation Analysis-->        
        <record model="ir.ui.view" id="view_prakruti_purchase_order_quotation_analysis_pivot">
            <field name="name">Purchase Quotation Analysis</field>
            <field name="model">prakruti.purchase_order_quotation_analysis</field>
            <field name="arch" type="xml">
                <pivot string="Purchase Quotation Analysis" display_quantity="True">
                    <field name="vendor_id" type="row"/>
                    <field name="state"/>
                </pivot>
            </field>
        </record>
        
        <!--     Action for Purchase Quotation Analysis-->    
        <record model="ir.actions.act_window" id="purchase_order_quotation_analysis_action">
            <field name="name">Purchase Quotation Analysis</field>
            <field name="res_model">prakruti.purchase_order_quotation_analysis</field>
            <field name="view_type">form</field>
            <field name="domain">[('revise_flag','=',0)]</field>
            <field name="view_mode">tree,form,pivot,graph</field>
        </record>
        
        <!--    Menu for Purchase Quotation Analysis-->
        <menuitem 
            name="Purchase Quotation Analysis" 
            id="purchase_order_quotation_analysis_sub_menu"
            action="purchase_order_quotation_analysis_action" 
            sequence="6"
            parent="prakruti.prakruti_purchase_main_sub_menu"
            groups="prakruti.group_prakruti_quotation_analysis_read_only,prakruti.group_prakruti_quotation_analysis_edit,prakruti.group_prakruti_quotation_analysis_create,prakruti.group_prakruti_quotation_analysis_delete"/>
    </data>
</openerp>