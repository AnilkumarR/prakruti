<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data> 
        
        <!--     Search View for Purchase Order-->   
        
        <record model="ir.ui.view" id="view_prakruti_purchase_order_search">
            <field name="name">Purchase Order</field>
            <field name="model">prakruti.purchase_order</field>
            <field name="arch" type="xml">
                <search string="Purchase Order">
                    <field name="product_id"/>
                    <field name='po_no'/>
                    <field name="order_date"/>
                    <field name='pr_no'/>
                    <field name="request_date"/>
                    <field name="vendor_id"/>
                    <field name="purchase_type"/>
                    <field name="state"/>
                    <field name='type_of_gst'/>
                    <separator/>
                    <filter string="# of Revision Order" domain="[('revise_flag','=',1)]"/>
                </search>
            </field>
        </record>
        
        <!--     Tree View for Purchase Order-->
        <record model="ir.ui.view" id="view_purchase_Order_tree">
            <field name="name">Purchase Order</field>
            <field name="model">prakruti.purchase_order</field>
            <field name="arch" type="xml">
                <tree string="Purchase Order" colors="green:state =='confirm';blue:state =='short_close';red:state =='reject';" create="false">
                    <field name='po_no'/>
                    <field name="order_date"/>
                    <field name='pr_no'/>
                    <field name="request_date"/>
                    <field name="vendor_id"/>
                    <field name="purchase_type"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>
        
        <!--     Form View for Purchase Order-->   
        
        <record model="ir.ui.view" id="view_Purchase_Order_form">
            <field name="name">Purchase Order</field>
            <field name="model">prakruti.purchase_order</field>
            <field name="arch" type="xml">
                <form string="Purchase Order" create="false">
                    <header>
                        <button name="reject_order" string="Reject Order" type="object" class="oe_highlight" groups="prakruti.group_purchase_rejection_management,base.group_no_one" attrs="{'invisible':['|',('state', 'in', ('order_close','reject','short_close')),('categorization', '=', ('services'))]}"/>
                        <button name="confirm_to_logistics" string="Confirm Order" class="oe_highlight" type="object" attrs="{'invisible':[('state', 'in', ('confirm','order_close','reject','short_close','partial_grn'))]}"/>
                        <button name="short_close_order" string="Short Close" type="object" class="oe_highlight" attrs="{'invisible':['|',('state', 'not in', ('confirm','order')),('categorization', '=', ('services'))]}"/>
                        <field name='state' widget='statusbar'/>
                    </header>
                        <group string = "Purchase Order"/>
                        <button name="revise_order" string="Is Revision Required ?" type="object" class="oe_highlight" attrs="{'invisible':['|',('state', 'not in',('order')),('revise_status', 'in', ('revise_order'))]}"/>                                         
                        <button name="revise_done" string="Revise Done" type="object" class="oe_highlight" attrs="{'invisible':[('revise_status', 'not in', ('revise_order'))]}"/>
                        <field name='revise_status' widget='statusbar' attrs="{'invisible':[('is_revise', '=', False)]}"/>
                        <group>                                 
                            <field name ="order_no" invisible="True"/>
                            <field name ="auto_no" invisible="True"/>
                            <field name ="req_no_control_id" invisible="True"/>
                            <field name ="order_close_flag" invisible="True"/>
                            <field name ='pr_common_id' invisible="True"/>
                            <field name ="revise_flag" invisible="True"/>
                        </group>
                        <group colspan="2" col="6">
                            <field name ="is_revise" attrs="{'invisible':[('is_revise', '=', False)]}"/>
                            <field name ="revise_no" attrs="{'invisible':[('is_revise', '=', False)]}"/>
                        </group>
                        <group colspan="2" col="6">                                 
                            <field name="purchase_type" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                            <field name='po_no' readonly= "True"/>                                 
                            <field name='pr_no' readonly= "True"/>
                            <field name='qa_no' readonly= "True"/>
                            <field name='qo_no' readonly= "True"/>
                            <field name='req_no' readonly= "True"/>
                            <field name="request_date" readonly= "True"/>
                            <field name="order_date" readonly= "True"/>
                            <field name='vendor_id' domain="[ ('supplier','=',True)]" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'in', ('reject','short_close'))]}"/>
                            <field name='vendor_reference' attrs="{'readonly':[('state', 'in', ('confirm','order_close','reject','short_close'))]}"/>                        
                            <field name='prepared_by' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'in', ('order','confirm','reject','short_close'))]}"/>
                            <field name='company_address' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'in', ('order','confirm','reject','short_close'))]}"/>                               
                            <field name='delivery_address' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'in', ('reject','short_close'))]}"/>
                            <field name='dispatch_through' attrs="{'readonly':[('state', 'in', ('confirm','order_close','reject','short_close'))]}"/>
                            <field name='type_of_gst'/>
                            <field name ="categorization" readonly="True"/>
                        </group>
                        <notebook>
                            <page string='Product Details'>
                                <field name='order_line' widget= 'one2many_list' />
                                <group>
                                    <group class="oe_subtotal_footer oe_right">                                      
                                        <field name='total_amount' invisible= '1'/>
                                        <field name='no_of_product' invisible= '1'/>
                                        <field name='proportionate_amount_to_products' invisible="1"/>
                                        <field name='total_taxable_value' invisible="1"/>
                                        <field name='amount_taxed'/>
                                        <field name='packing_charges' attrs="{'readonly':[('state', 'in', ('confirm','order_close','reject','short_close'))]}"/>
                                        <field name='frieght_charges_applied' attrs="{'readonly':[('state', 'in', ('confirm','order_close','reject','short_close'))]}"/>
                                        <field name='frieght_charges'  attrs="{'invisible':[('frieght_charges_applied', '!=', 'yes')], 
                                                                               'readonly':[('state', 'in', ('confirm','order_close','reject','short_close'))]
                                                                              }"/> 
                                        <field name='additional_charges' attrs="{'readonly':[('state', 'in', ('confirm','order_close','reject','short_close'))]}"/>
                                        <field name ='insurance_charges' attrs="{'readonly':[('state', 'in', ('confirm','order_close','reject','short_close'))]}"/>
                                        <field name='total_cgst'/>
                                        <field name='total_sgst'/>
                                        <field name='total_igst'/>
                                        <field name='total_gst'/>
                                        <field name='grand_total'/>
                                        <field name='grand_total_after_payments'/>                                             
                                        <button name="calculate_total" string="(update)" type="object" class="oe_edit_only oe_link"/><newline/>
                                        <field name="grand_total_in_words" invisible="True"/>
                                        <field name="gst_total_in_words" invisible="True"/>
                                    </group>
                                </group>
                            </page>
                            <page string='Other details'>
                                <group colspan="2" col="6">
                                    <field name="payment" attrs="{'readonly':[('state', 'in', ('confirm','order_close','reject','short_close'))]}"/>                                     
                                    <field name='destination' attrs="{'readonly':[('state', 'in', ('confirm','order_close','reject','short_close'))]}"/>
                                    <field name='other_reference' attrs="{'readonly':[('state', 'in', ('confirm','order_close','reject','short_close'))]}"/>
                                    <field name ="plant_manager" attrs="{'readonly':[('state', 'in', ('confirm','order_close','reject','short_close'))]}"/>
                                    <field name ="to_name" attrs="{'readonly':[('state', 'in', ('confirm','order_close','reject','short_close'))]}"/>
                                    <field name ="document_no" attrs="{'readonly':[('state', 'in', ('confirm','order_close','reject','short_close'))]}"/>
                                    <field name ="revision_no" attrs="{'readonly':[('state', 'in', ('confirm','order_close','reject','short_close'))]}"/>
                                    <field name ="default_pr_date" attrs="{'readonly':[('state', 'in', ('confirm','order_close','reject','short_close'))]}"/>
                                    <field name ="maintanence_manager" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'in', ('confirm','order_close','reject','short_close'))]}"/>                                   
                                    <field name ="purchase_manager" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'in', ('confirm','order_close','reject','short_close'))]}"/>
                                    <field name ="stores_incharge" invisible="True"/>
                                    <field name='terms_of_delivery' attrs="{'readonly':[('state', 'in', ('confirm','order_close','reject','short_close'))]}"/>
                                    <field name='remarks' attrs="{'readonly':[('state', 'in', ('order_close','reject','short_close'))]}"/>
                                    <field name='short_close_remarks' attrs="{'readonly':[('state', 'in', ('order_close','reject','short_close'))]}"/>
                                    <field name ="revise_remarks" placeholder='Enter Revise Remarks Here...' attrs="{'invisible': [('is_revise', '=', False)]}"/>
                                    <field name ="revise_id" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'invisible': [('is_revise', '=', False)]}"/>
                                    <field name ="revise_remarks_update" />
                                </group>
                            </page>
                            <page string="Payment Details">
                                <group>
                                    <group colspan="2" col="6">
                                        <field name='any_adv_payment'/>
                                        <field name='advance_payment_type' attrs="{'invisible':[('any_adv_payment', '!=', 'yes')]}"/>
                                        <group string="Cash Details" attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cash'))]}">
                                            <field name='cash_amount' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cash'))]}"/>
                                            <field name='cash_remarks' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cash'))]}"/>
                                        </group>
                                        <group string="Cheque Details" attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cheque'))]}">
                                            <field name='cheque_amount' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cheque'))]}"/>
                                            <field name='cheque_no' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cheque'))]}"/>
                                            <field name='cheque_remarks' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cheque'))]}"/>
                                        </group>
                                        <group string="Draft Details" attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('demand_draft'))]}">
                                            <field name='draft_amount' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('demand_draft'))]}"/>
                                            <field name='draft_no' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('demand_draft'))]}"/>
                                            <field name='draft_remarks' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('demand_draft'))]}"/>
                                        </group>
                                    </group>
                                </group>
                            </page> 
                    </notebook>
                </form>
            </field>
        </record>
        
        <!--     Tree View for Purchase Order-->
        <record model="ir.ui.view" id="view_prakruti_purchase_line_tree">
            <field name="name">Purchase Order</field>
            <field name="model">prakruti.purchase_line</field>
            <field name="arch" type="xml">
                <tree editable='bottom' create= "false" delete="false">
                    <field name='product_id' on_change="onchange_product_id(product_id)" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" domain="[('group_ref','=',parent.purchase_type)]" attrs="{'readonly':[('revise_order_line', 'in',(0,2))]}"/>
                    <field name='description' attrs="{'readonly':[('revise_order_line', 'in',(0,2))]}"/>
                    <field name='uom_id' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" />
                    <field name='scheduled_date' attrs="{'readonly':[('revise_order_line', '=',(2))]}"    />
                    <field name='required_date' attrs="{'readonly':[('revise_order_line', 'in',(0,2))]}"/>
                    <field name="no_of_packings" attrs="{'readonly':[('revise_order_line', '=',(2))]}"/>
                    <field name="pack_per_qty" attrs="{'readonly':[('revise_order_line', '=',(2))]}"/>
                    <field name="extra_packing" attrs="{'readonly':[('revise_order_line', '=',(2))]}"/>
                    <field name='quantity' attrs="{'readonly':[('revise_order_line', 'in',(0,2))]}" />
                    <field name='balance_qty' readonly="True"/>
                    <field name='unit_price' attrs="{'readonly':[('revise_order_line', '=',2)]}"/>
                    <field name='hsn_code'  />
                    <field name='discount_rate' attrs="{'readonly':[('revise_order_line', '=',(2))]}" />
                    <field name='taxable_value'/>
                    <field name='taxable_value_after_adding_other'/>
                    <field name='cgst_id' attrs="{'readonly':[('revise_order_line', '=',(2))]}"  options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name='cgst_value'/>
                    <field name='sgst_id' attrs="{'readonly':[('revise_order_line', '=',(2))]}"  options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name='sgst_value'/>
                    <field name='igst_id' attrs="{'readonly':[('revise_order_line', '=',(2))]}"   options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name='igst_value'/>
                    <field name='subtotal'/>
                    <field name='remarks' />
                    <field name="status"/>
                    <field name="revise_order_line" invisible="True"/>
                </tree>
            </field>
        </record>
        
        <!--     Pivot View for Purchase Order-->
        <record model="ir.ui.view" id="view_prakruti_purchase_order_pivot">
            <field name="name">Purchase Order</field>
            <field name="model">prakruti.purchase_order</field>
            <field name="arch" type="xml">
                <pivot string="Purchase Order" display_quantity="True">
                    <field name="vendor_id" type="row"/>
                    <field name="state" />
                </pivot>
            </field>
        </record>
        
        <!--     Graph View for Purchase Order-->
        <record model="ir.ui.view" id="view_prakruti_purchase_order_graph">
            <field name="name">Purchase Order</field>
            <field name="model">prakruti.purchase_order</field>
            <field name="arch" type="xml">
                <graph string="Purchase Order" type="bar" >
                    <field name="vendor_id" />
                    <field name="po_no" />
                </graph>
            </field>
        </record>  
        
        <!--     Action for Purchase Order-->
        <record model="ir.actions.act_window" id="purchase_order_action">
            <field name="name">Purchase Order</field>
            <field name="res_model">prakruti.purchase_order</field>
            <field name="view_type">form</field>
            <field name="domain">[('revise_flag','=',0)]</field>
            <field name="view_mode">tree,form,pivot,graph</field>
        </record>
	
        
        <!--     Menu for Purchase Order-->
        <menuitem 
            name="Purchase Order" 
            id="purchase_sub_menu_1"
            action="purchase_order_action" 
            sequence="7"
            parent="prakruti.prakruti_purchase_main_sub_menu"
            groups="group_prakruti_purchase_order_read_only,prakruti.group_prakruti_purchase_order_edit,prakruti.group_prakruti_purchase_order_create,prakruti.group_prakruti_purchase_order_delete"/>
    </data>
</openerp>
