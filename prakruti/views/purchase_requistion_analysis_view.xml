<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        
        <!--     Search View for Purchase Requisition Analysis-->
        <record model="ir.ui.view" id="view_prakruti_purchase_requistion_analysis_search">
            <field name="name">prakruti.purchase_requistion_analysis.search</field>
            <field name="model">prakruti.purchase_requistion_analysis</field>
            <field name="arch" type="xml">
                <search string="Product Wise Search">
                    <field name="product_id"/>
                    <field name ="analysis_no"/>
                    <field name ="request_no"/>
                    <field name ="purchase_type"/>
                    <field name ="to_name" />
                    <field name ="prepared_by"/>
                    <field name ="approved_by"/>
                    <field name ="state"/>
                </search>
            </field>
        </record>
        
        <!--     Tree View for Purchase Requisition Analysis-->
        <record id="view_purchase_requistion_analysis_tree" model="ir.ui.view">
            <field name="name">prakruti.purchase_requistion_analysis.tree</field>
            <field name="model">prakruti.purchase_requistion_analysis</field>
            <field name="arch" type="xml">
                <tree string ="Purchase Requisition Analysis" create= "false"  colors="green:state =='confirm';red:state =='rejected';">
                    <field name ="analysis_no"/>
                    <field name ="request_no"/>
                    <field name ="request_date"/>
                    <field name ="purchase_type"/>
                    <field name ="to_name" />
                    <field name ="prepared_by"/>
                    <field name ="approved_by"/>
                    <field name ="approved_date"/>
                    <field name ="state"/>
                </tree>
            </field>
        </record>
        
        <!--     Form View for Purchase Requisition Analysis-->
    
        <record id="view_purchase_requistion_analysis_form" model="ir.ui.view">
            <field name="name">prakruti.purchase_requistion_analysis.form</field>
            <field name="model">prakruti.purchase_requistion_analysis</field>
            <field name="arch" type="xml">
                <form string = "Purchase Requisition Analysis" create= "false">   
                    <header>                   
                        <button name="action_price_request" string="Raise Request" type="object" attrs="{'invisible':[('state', 'in', ('request','quotation', 'analysis','order','confirm','rejected'))]}"/> 
                        <button name="req_analysis_to_order" string="Raise Order" type="object" attrs="{'invisible':[('state', 'in', ('request','quotation', 'analysis','order','confirm','rejected'))]}"/>
                        <field name='state' widget='statusbar'/>
                    </header>
                    <group string = "Purchase Requisition Analysis"/>
                    <button name="revise_requisition" string="Is Revision Required ?" type="object" class="oe_highlight" attrs="{'invisible':['|',('state', 'not in',('requisition_analysis')),('revise_status', 'in', ('revise_requisition'))]}"/>                                         
                    <button name="revise_done" string="Revise Done" type="object" class="oe_highlight" attrs="{'invisible':[('revise_status', 'not in', ('revise_requisition'))]}"/>
                    <field name='revise_status' widget='statusbar' attrs="{'invisible':[('is_revise', '=', False)]}"/>                    
                    <group>                 
                        <field name ="inq_no" invisible="True"/>
                        <field name ="auto_no" invisible="True"/>
                        <field name ="req_no_control_id" invisible="True"/>
                        <field name="revise_flag" invisible="True"/>    
                        <field name ="validate_flag" invisible="True"/>
                    </group>
                    <group colspan="2" col="6">
                        <field name ="is_revise" attrs="{'invisible':[('is_revise', '=', False)]}"/>
                        <field name ="revise_no" attrs="{'invisible':[('is_revise', '=', False)]}"/>
                    </group>
                    <group colspan="2" col="6">
                        <field name ="purchase_type" readonly="True" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                        <field name ="company_id" readonly="True"/>       
                        <field name ="request_no" />
                        <field name ="request_date" readonly="True"/>
                        <field name ="analysis_no" />
                        <field name ="inquiry_date" readonly="True"/>
                        <field name ="approved_date" readonly="True"/> 
                        <field name ="categorization" readonly="True"/>             
                    </group>
                    <notebook>                    
                        <page string="Product Details" >
                            <field name ="requistion_order_line" attrs="{'readonly':[('state', 'not in', ('requisition_analysis','partial_confirm','partial_analysis')),('revise_status', 'not in', ('revise_requisition'))]}">
                                <tree editable='bottom' create= "false"  >
                                    <field name='product_id' on_change="onchange_product_id(product_id)"  options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" domain="[ ('group_ref','=',parent.purchase_type)]" attrs="{'readonly':['|',('revise_req_analysis_line', 'in', (0,2)),('send_status', '=', 1)]}"/>           
                                    <field name="description" attrs="{'readonly':[('revise_req_analysis_line', 'in', (0,2))]}"/>                                   
                                    <field name="quantity_req" attrs="{'readonly':[('revise_req_analysis_line', 'in', (0,2))]}"/>
                                    <field name="uom_id" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('revise_req_analysis_line', 'in', (0,2))]}"/>                                    
                                    <field name="required_date" attrs="{'readonly':[('revise_req_analysis_line', '=', (2))]}"/>
                                    <field name="vendor_id" domain="[ ('supplier','=',True)]" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True, 'no_show':True, 'no_quick_create': True, }" attrs="{'readonly':['|',('revise_req_analysis_line', '=', (2)),('send_status', '=', 1)]}"/>
                                    <field name="last_purchase_date"/>
                                    <field name="last_purchase_vendor_id"/>
                                    <field name="last_price"/> 
                                    <field name="status" attrs="{'readonly':['|',('revise_req_analysis_line', '=', (2)),('send_status', '=', 1)]}"/>
                                    <field name="send_status" invisible="True"/>
                                    <field name="send_to"/>
                                    <field name="short_close_status"/>
                                    <field name="reject_status"/>
                                    <field name="remarks" attrs="{'readonly':[('revise_req_analysis_line', 'in', (0,2))]}"/>  
                                    <field name="request_no" invisible="True"/>
                                    <field name="requisition_grid_id" invisible="True"/>
                                    <field name='hsn_code' invisible="True"/>
                                    <field name='revise_req_analysis_line' invisible="True"/>
                                </tree>
                            </field>                 
                        </page>      
                        <page string="Other Details">                             
                            <group colspan="2" col="6">  
                                <field name="terms_and_conditions" placeholder= "Terms and Conditions" attrs="{'readonly':[('state', 'not in', ('requisition_analysis'))]}"/>
                                <field name="remarks" placeholder= "Remarks" attrs="{'readonly':[('state', 'not in', ('requisition_analysis'))]}"/>
                                <field name ="prepared_by" string="Prepared by" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'not in', ('requisition_analysis'))]}"/>
                                <field name ="approved_by" string="Approved by" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'not in', ('requisition_analysis'))]}"/>
                                <field name ="plant_manager" attrs="{'readonly':[('state', 'not in', ('requisition_analysis'))]}"/>
                                <field name ="purchase_manager" attrs="{'readonly':[('state', 'not in', ('requisition_analysis'))]}"/>
                                <field name ="document_no" attrs="{'readonly':[('state', 'not in', ('requisition_analysis'))]}"/>
                                <field name ="revision_no" attrs="{'readonly':[('state', 'not in', ('requisition_analysis'))]}"/>
                                <field name ="default_pr_date" attrs="{'readonly':[('state', 'not in', ('requisition_analysis'))]}"/>
                                <field name ="to_name" attrs="{'readonly':[('state', 'not in', ('requisition_analysis'))]}"/>
                                <field name ="revise_remarks" placeholder='Enter Revise Remarks Here...' attrs="{'invisible': [('is_revise', '=', False)]}"/>
                                <field name ="revise_id" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'invisible': [('is_revise', '=', False)]}"/>
                                <field name ="revise_remarks_update" />
                            </group>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>
        
        <!--     Pivot View for Purchase Requisition Analysis-->
        
        <record model="ir.ui.view" id="view_prakruti_purchase_requistion_analysis_pivot">
            <field name="name">prakruti.purchase_requistion_analysis.pivot</field>
            <field name="model">prakruti.purchase_requistion_analysis</field>
            <field name="arch" type="xml">
                <pivot string=" Purchase Requisition Analysis" display_quantity="True">
                    <field name="analysis_no" type="row"/>
                    <field name="prepared_by"/>
                </pivot>
            </field>
        </record>
        
        <!--     Action View for Purchase Requisition Analysis-->
    
        <record model="ir.actions.act_window" id="action_purchase_requistion_analysis">
            <field name="name">Purchase Requisition Analysis</field>
            <field name="res_model">prakruti.purchase_requistion_analysis</field>
            <field name="view_type">form</field>
            <field name="domain">[('revise_flag','=',0)]</field>
            <field name="view_mode">tree,form,pivot</field>	
        </record>
        
        <!--     Menu for Purchase Requisition Analysis-->
    
        <menuitem 
            name="Purchase Requistion Analysis" 
            id="menu_purchase_requistion_analysis"
            action="action_purchase_requistion_analysis" 
            sequence="3"
            parent="prakruti.prakruti_purchase_main_sub_menu"
            groups="prakruti.group_prakruti_requisition_analysis_read_only,prakruti.group_prakruti_requisition_analysis_edit,prakruti.group_prakruti_requisition_analysis_create,prakruti.group_prakruti_requisition_analysis_delete"
            />     
    
     
    </data>
</openerp>