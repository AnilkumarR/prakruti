<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data> 
        
        <!--  Search View for Purchase Invoice-->
        <record model="ir.ui.view" id="view_prakruti_purchase_invoice_search">
            <field name="name">Purchase Invoice</field>
            <field name="model">prakruti.purchase_invoice</field>
            <field name="arch" type="xml">
                <search string="Purchase Invoice">
                    <field name="product_id"/>            
                    <field name="purchase_invoice_no"/>
                    <field name='po_no'/>
                    <field name='pr_no'/>
                    <field name="status"/>
                </search>
            </field>
        </record>
        
        <!--  Tree View for Purchase Invoice-->
        <record model="ir.ui.view" id="view_purchase_invoice_tree">
            <field name="name">Purchase Invoice</field>
            <field name="model">prakruti.purchase_invoice</field>
            <field name="arch" type="xml">
                <tree string="Purchase Invoice">              
                    <field name ="purchase_invoice_no"/>    
                    <field name ="purchase_invoice_date"/> 
                    <field name='po_no'/>
                    <field name="order_date"/>
                    <field name='pr_no'/>
                    <field name="request_date" />
                    <field name="status"/>
                </tree>
            </field>
        </record>
        
        <!--   Form View for Purchase Invoice-->
        <record model="ir.ui.view" id="view_purchase_invoice_form">
            <field name="name">Purchase Invoice</field>
            <field name="model">prakruti.purchase_invoice</field>
            <field name="arch" type="xml">
                <form string="Purchase Invoice" >
                    <button name="purchase_invoice_to_purchase_order" string="Generate Invoice" type="object" attrs="{'invisible':['|',('order_close_flag', '=',1),('order_close_pending', '=',1)]}"/>
                    <group string = 'Purchase Invoice'/>
                    <group colspan="2" col="6">          
                        <field name='flag_count_display_product' invisible="True"/>                                 
                        <field name='qa_no' invisible="True"/>
                        <field name='qo_no' invisible="True"/>
                        <field name='req_no' invisible="True"/>                                 
                        <field name='vendor_reference' invisible="True"/>
                        <field name='pr_common_id' invisible="True"/>
                        <field name='order_close_flag' invisible="True"/> 
                        <field name='order_close_pending' invisible="True"/>        
                        <field name='pur_inv_no' invisible="True"/>
                        <field name='auto_no2' invisible="True"/> 
                        <field name='req_no_control_id2' invisible="True"/>
                        <field name='delivery_address' invisible="True" />
                        <field name ="list_in_pi_line"  invisible="True" />
                    </group>
                    <group colspan="2" col="6">                        
                        <field name ='grn_id' on_change="onchange_grn_id(grn_id)" domain="[('state', '=','done'),('order_close_flag','=',0)]" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" placeholder="Select GRN No." attrs="{'invisible':[('categorization', '=','services'),]}"/>
                        
                        <field name ="po_num"   on_change="onchange_po_no(po_num)" domain="[('state', '=','confirm'),('categorization', '=','services'),('order_close_flag','=',0)]" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" placeholder="Select PO No." attrs="{'invisible':[('categorization', 'in',('goods','goods_services'))]}"/>
                        
                        <field name ="categorization"/>
                        <field name ="purchase_type" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>               
                        <field name ="purchase_invoice_no"/>   
                        <field name ="purchase_invoice_date"/> 
                        <field name ='po_no' attrs="{'invisible':[('categorization', '=','services'),]}"/>
                        <field name ='pr_no' />
                        <field name ="request_date"/>
                        <field name ="order_date" />
                        <field name ='vendor_id' domain="[ ('supplier','=',True)]" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" />
                        <field name ='prepared_by' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" />
                        <field name ='company_address' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" />
                        <field name ='dispatch_through' />
                    </group>
                    <button name="action_list_products"  string="GRN List" type="object" attrs="{'invisible':['|',('flag_count_display_product','in',(1,2)),('list_in_pi_line','=',2)]}"/>
                    <button name="action_list_products_po"  string="Order List" type="object" attrs="{'invisible':['|',('flag_count_display_product','in',(1,2)),('list_in_pi_line','=',0)]}"/>
                    <button name="action_delete_products"  string="Delete" type="object" />
                    <notebook>
                        <page string='Product Details'>
                            <field name='invoice_line' widget= 'one2many_list'/> 
                            <group>
                                <group class="oe_subtotal_footer oe_right" >
                                    <field name='total_amount' invisible= '1'/>
                                    <field name='all_additional_charges' invisible= '1'/>
                                    <field name='proportionate_amount_to_products' invisible= '1'/>
                                    <field name='total_taxable_value' invisible= '1'/>
                                    <field name='amount_taxed'/>
                                    <field name='packing_charges' />
                                    <field name='frieght_charges_applied' />
                                    <field name='frieght_charges'  attrs="{'invisible':[('frieght_charges_applied', '!=', 'yes')]}"/>
                                    <field name='additional_charges' />
                                    <field name='insurance_charges' />
                                    <field name='total_cgst'/>
                                    <field name='total_sgst'/>
                                    <field name='total_igst'/>
                                    <field name='total_gst'/>
                                    <field name='grand_total'/> 
                                    <field name='grand_total_after_payments'/>
                                    <field name='gst_total_in_words' invisible= '1'/>
                                    <field name='grand_total_in_words' invisible= '1'/>                                            
                                    <button name="calculate_total" string="(update)" type="object" class="oe_edit_only oe_link"/><newline/>
                                </group>
                            </group>
                        </page>
                        <page string='Other details'>
                            <group string = 'Store Information'/>
                                <group colspan="2" col="6">
                                    <field name="payment"  />
                                    <field name='terms_of_delivery' />
                                    <field name ="stores_incharge" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" />
                                    <field name ="purchase_manager" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                                    <field name="revision_no" readonly="True"/>
                                    <field name="document_no" readonly="True"/>
                                    <field name ="plant_manager" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" />
                                    <field name ="to_name"  options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" />
                                    <field name ="default_pr_date"  readonly= "True"/>
                                </group>
                                <group string = 'Documents Details'/>
                                <group colspan="2" col="6">
                                    <field name='gc_no' />                                 
                                    <field name='gc_date'/>
                                    <field name='dc_no' />                                 
                                    <field name='dc_date'/>
                                    <field name='doc_no' readonly= "True"/>
                                    <field name='rev_no' readonly= "True"/>
                                    <field name='doc_date' readonly= "True"/>
                                    <field name='remarks'/>
                                </group>
                                <group string = 'Transporter Details'/>
                                <group colspan="2" col="6">                                        
                                    <field name='transporter_name'/>
                                    <field name='transporter_payment_details' />
                                </group>
                        </page> 
                        <page string="Payment Details">
                            <group>
                                <group colspan="2" col="6">
                                    <field name='any_adv_payment'/>
                                    <field name='advance_payment_type' attrs="{'invisible':[('any_adv_payment', '!=', 'yes')]}"/>
                                    <group string="Cash Details" attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cash'))]}">
                                        <field name='cash_amount' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cash'))]}"/>
                                        <field name='cash_remarks' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cash'))]}"/>
                                    </group>
                                    <group string="Cheque Details" attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cheque'))]}">
                                        <field name='cheque_amount' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cheque'))]}"/>
                                        <field name='cheque_no' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cheque'))]}"/>
                                        <field name='cheque_remarks' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('cheque'))]}"/>
                                    </group>
                                    <group string="Draft Details" attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('demand_draft'))]}">
                                        <field name='draft_amount' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('demand_draft'))]}"/>
                                        <field name='draft_no' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('demand_draft'))]}"/>
                                        <field name='draft_remarks' attrs="{'invisible':['|',('any_adv_payment', '!=', 'yes'),('advance_payment_type', 'not in', ('demand_draft'))]}"/>
                                    </group>
                                </group>
                            </group>
                        </page> 
                  </notebook>
                </form>
            </field>
        </record>
        
        <!--     Tree View for Purchase Invoice line-->
        <record model="ir.ui.view" id="view_prakruti_purchase_invoice_line_tree">
            <field name="name">Purchase Invoice</field>
            <field name="model">prakruti.purchase_invoice_line</field>
            <field name="arch" type="xml">  
                <tree editable='bottom' create= "false" delete="false">
                    <field name='product_id' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" domain="[('p_type','=',parent.purchase_type)]" />
                    <field name='description' />
                    <field name='uom_id' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name='actual_quantity'/>
                    <field name='no_of_packings' />
                    <field name='pack_per_qty' />
                    <field name="extra_packing"/>
                    <field name='quantity' />
                    <field name='unit_price'/>
                    <field name='hsn_code'  />
                    <field name='discount_rate' />
                    <field name='taxable_value'/>
                    <field name='taxable_value_after_adding_other'/>
                    <field name='cgst_id' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name='cgst_rate' invisible="True"/>
                    <field name='cgst_value'/>
                    <field name='sgst_id' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name='sgst_rate' invisible="True"/>
                    <field name='sgst_value'/>
                    <field name='igst_id' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name='igst_rate' invisible="True"/>
                    <field name='igst_value'/>
                    <field name='subtotal'/>
                    <field name='discount_value' invisible="True"/>
                    <field name='remarks'/>
                    <field name="status" />
                </tree>
            </field>
        </record>
        
        <!--     Pivot View for Purchase Invoice-->
        <record model="ir.ui.view" id="view_prakruti_purchase_invoice_pivot">
            <field name="name">Purchase Invoice</field>
            <field name="model">prakruti.purchase_invoice</field>
            <field name="arch" type="xml">
                <pivot string="Purchase Invoice" display_quantity="True">
                    <field name="status" type="row"/>
                    <field name="vendor_id"/>
                </pivot>
            </field>
        </record>
        
        <!--     Action for Purchase Invoice-->
        <record model="ir.actions.act_window" id="purchase_invoice_action">
            <field name="name">Purchase Invoice</field>
            <field name="res_model">prakruti.purchase_invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,pivot</field>
        </record>
        
        <!--     Menu for Purchase Invoice-->
        <menuitem 
            name="Purchase Invoice" 
            id="purchase_sub_menu_invoice" 
            action="purchase_invoice_action" 
            sequence="8" 
            parent="prakruti.prakruti_purchase_main_sub_menu" groups="prakruti.group_prakruti_purchase_invoice_read_only,prakruti.group_prakruti_purchase_invoice_edit,prakruti.group_prakruti_purchase_invoice_create,prakruti.group_prakruti_purchase_invoice_delete"/>               
    </data>
</openerp>