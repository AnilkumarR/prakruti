<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        
        <!--     Search View for Purchase Price request-->
        <record model="ir.ui.view" id="view_prakruti_price_request_search">
            <field name="name">prakruti.price_request.search</field>
            <field name="model">prakruti.price_request</field>
            <field name="arch" type="xml">
                <search string="Product Wise Search">
                    <field name="product_id"/>
                    <field name ="inquiry_no"/>
                    <field name ="request_no"/>
                    <field name ="purchase_type"/>
                    <field name ="prepared_by" />
                    <field name="state"/>
                </search>
            </field>
        </record>
        
        <!--     Tree View for Purchase Price request-->   
        <record id="view_price_request_tree" model="ir.ui.view">
            <field name="name">prakruti.price_request.tree</field>
            <field name="model">prakruti.price_request</field>
            <field name="arch" type="xml">
                <tree string = "Price Request" create= "false">
                    <field name ="inquiry_no"/>
                    <field name ="request_no"/>
                    <field name ="request_date"/>
                    <field name ="purchase_type"/>
                    <field name ="prepared_by" />
                    <field name ="state"/>
                </tree>
            </field>
        </record>
        
        <!--     Form View for Purchase Price request-->
        <record id="view_price_request_form" model="ir.ui.view">
            <field name="name">prakruti.price_request.form</field>
            <field name="model">prakruti.price_request</field>
            <field name="arch" type="xml">
                <form string = "Price Request" create= "false">   
                    <header>                   
                        <button name="action_quotation" string="To Quotation" type="object" attrs="{'invisible':[('state', 'in', ('quotation', 'analysis','order','confirm','reject','short_close'))]}"/>                    
                        <field name='state' widget='statusbar'/>
                    </header>
                    <group string = "Price Request"/>
                    <button name="revise_request" string="Is Revision Required ?" type="object" class="oe_highlight" attrs="{'invisible':['|',('state', 'not in',('request')),('revise_status', 'in', ('revise_request'))]}"/>                                         
                    <button name="revise_done" string="Revise Done" type="object" class="oe_highlight" attrs="{'invisible':[('revise_status', 'not in', ('revise_request'))]}"/>
                    <field name='revise_status' widget='statusbar' attrs="{'invisible':[('is_revise', '=', False)]}"/>
                    <group>                 
                        <field name ="inq_no" invisible="True"/>
                        <field name ="auto_no" invisible="True"/>
                        <field name ="req_no_control_id" invisible="True"/>
                        <field name="revise_flag" invisible="True"/>
                    </group>
                    <group colspan="2" col="6">
                        <field name ="is_revise" attrs="{'invisible':[('is_revise', '=', False)]}"/>
                        <field name ="revise_no" attrs="{'invisible':[('is_revise', '=', False)]}"/>
                    </group>
                    <group colspan="2" col="6">
                        <field name ="purchase_type" options="{'no_create': True, 'no_open': True}" readonly="True"/>
                        <field name ="request_no"/>
                        <field name ="request_date" readonly="True"/>
                        <field name ="inquiry_no"/>
                        <field name ="inquiry_date" readonly="True"/> 
                        <field name ="categorization" readonly="True"/>
                        <field name ="company_id" readonly="True"/>             
                    </group>
                    <notebook>                    
                        <page string="Product Details" >
                            <field name ="request_order_line" />
                        </page>                        
                        <page string="Vendor Details" >
                            <field name ="vendor_list_line" >
                                <tree editable='bottom'>
                                    <field name="vendor_id" domain="[ ('supplier','=',True)]" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                                    <field name="address_type"/>
                                    <field name="address"/>
                                    <field name="remarks"/>
                                </tree>
                            </field>
                        </page>                        
                        <page string="Other Details" >      
                            <group colspan="2" col="6">
                                <field name="terms_and_conditions" placeholder= "Terms and Conditions" attrs="{'readonly':[('state', 'not in', ('request'))]}"/>
                                <field name="remarks" placeholder= "Remarks" attrs="{'readonly':[('state', 'not in', ('request'))]}"/>
                                <field name ="prepared_by" string="Prepared by" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'not in', ('request'))]}"/>
                                <field name ="approved_by" string="Approved by" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state', 'not in', ('request'))]}"/>
                                <field name ="plant_manager" attrs="{'readonly':[('state', 'not in', ('request'))]}"/>
                                <field name ="to_name" attrs="{'readonly':[('state', 'not in', ('request'))]}"/>
                                <field name ="purchase_manager" attrs="{'readonly':[('state', 'not in', ('request'))]}"/>
                                <field name ="document_no" attrs="{'readonly':[('state', 'not in', ('request'))]}"/>
                                <field name ="revision_no" attrs="{'readonly':[('state', 'not in', ('request'))]}"/>
                                <field name ="default_pr_date" attrs="{'readonly':[('state', 'not in', ('request'))]}"/>
                                <field name ="revise_remarks" placeholder='Enter Revise Remarks Here...' attrs="{'invisible': [('is_revise', '=', False)]}"/>
                                <field name ="revise_id" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'invisible': [('is_revise', '=', False)]}"/>
                                <field name ="revise_remarks_update" />
                            </group>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>
        
        <!--     Tree View for Purchase Price request Line-->
        <record model="ir.ui.view" id="view_price_request_line_tree">
            <field name="name">prakruti.price_request_line.tree</field>
            <field name="model">prakruti.price_request_line</field>
            <field name="arch" type="xml">
                <tree editable='bottom'>
                    <field name='product_id' on_change="onchange_product_id(product_id)"  options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" domain="[ ('group_ref','=',parent.purchase_type)]" attrs="{'readonly':[('revise_price_req_line', 'in',(0,2))]}"/>           
                    <field name="description" attrs="{'readonly':[('revise_price_req_line', 'in',(0,2))]}"/>                                   
                    <field name="quantity_req" attrs="{'readonly':[('revise_price_req_line', 'in',(0,2))]}"/>
                    <field name="uom_id" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('revise_price_req_line', 'in',(0,2))]}"/>                                    
                    <field name="required_date" readonly="True"/>
                    <field name="last_purchase_date"/>
                    <field name="last_purchase_vendor_id"/>
                    <field name="last_price"/> 
                    <field name="remarks" attrs="{'readonly':[('revise_price_req_line', 'in',(0,2))]}"/>  
                    <field name="revise_price_req_line" invisible="True"/>                                      
                </tree>
            </field>
        </record>
        
        <!--     Pivot View for Purchase Price request-->
        <record model="ir.ui.view" id="view_prakruti_price_request_pivot">
            <field name="name">prakruti.price_request.pivot</field>
            <field name="model">prakruti.price_request</field>
            <field name="arch" type="xml">
                <pivot string="Price Request" display_quantity="True">
                    <field name="prepared_by" type="row"/>
                    <field name="state"/>
                </pivot>
            </field>
        </record>
        
        <!--     Action View for Purchase Price request-->
    
        <record model="ir.actions.act_window" id="price_request_view">
            <field name="name">Price Request</field>
            <field name="res_model">prakruti.price_request</field>
            <field name="view_type">form</field>
            <field name="domain">[('revise_flag','=',0)]</field>
            <field name="view_mode">tree,form,pivot</field>	
        </record>
        
        <!--     Menu for Purchase Price request-->
    
        <menuitem 
            name="Purchase Price Request" 
            id="price_request_view_menu"
            action="price_request_view" 
            sequence="4"
            parent="prakruti.prakruti_purchase_main_sub_menu" 
            groups="prakruti.group_prakruti_price_request_read_only,prakruti.group_prakruti_price_request_edit,prakruti.group_prakruti_price_request_create,prakruti.group_prakruti_price_request_delete"/>     
    
     
    </data>
</openerp>