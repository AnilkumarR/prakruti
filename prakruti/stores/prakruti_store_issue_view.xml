<?xml version="1.0" encoding="utf-8"?>
<openerp>
 <data>
         <!--  Search view for Store Issue   -->
        <record model="ir.ui.view" id="view_prakruti_store_issue_search">
            <field name="name">prakruti.store_issue.search</field>
            <field name="model">prakruti.store_issue</field>
            <field name="arch" type="xml">
                <search string="Search">
                    <field name="product_id"/>               
                   <field name="request_no"/>
                   <field name='approved_by'/>
                   <field name='issue_no'/>
                   <field name='issue_date'/>
                   <field name='issued_by'/>
                   <field name='batch_no' />
                   <field name='subplant_id' />
                   <field name='coming_from'/>
                   <field name='status'/>
                </search>
            </field>
        </record>
    
     
        <!-- Tree view of    Store Issue -->
        <record model="ir.ui.view" id="view_prakruti_store_issue_tree">
            <field name="name">prakruti.store_issue.tree</field>
            <field name="model">prakruti.store_issue</field>
            <field name="arch" type="xml">
                <tree string="Store Issue" create='false'>                  
                   <field name="request_no"/>
                   <field name='approved_by'/>
                   <field name='issue_no'/>
                   <field name='issue_date'/>
                   <field name='issued_by'/>
                   <field name='batch_no' />
                   <field name='subplant_id' />
                   <field name='coming_from'/>
                   <field name='status'/>
                </tree>
            </field>
        </record>
        
        
         <!--  Form view for Store Issue   -->
        <record model="ir.ui.view" id="view_prakruti_store_issue_form">
            <field name="name">prakruti.store_issue.form</field>
            <field name="model">prakruti.store_issue</field>
            <field name="arch" type="xml">
             <form string="Store Issue" create='false'>
                  <header>                   
                      <button name="UpdateIssueStock" string="Dispatch" type="object" attrs="{'invisible':[('status', 'in', ('issue','partial_issue','extra_issue','return_stock'))]}"/>
                      <button name="return_to_stock" string="Stock Update" type="object" attrs="{'invisible':[('status', 'in', ('waiting','return_stock'))]}"/>
                      <field name='status' widget="statusbar"/> 
                  </header>
                  <group>
                        <button name="revise_issue" string="Is Revision Required ?" type="object" class="oe_highlight" attrs="{'invisible':['|',('status', 'not in',('waiting')),('revise_status', 'in', ('revise_issue'))]}"/>        
<!--                         ['Extraction BOM','Tablet BOM','Syrup BOM']                          -->
                        <button name="revise_done" string="Revise Done" type="object" class="oe_highlight" attrs="{'invisible':[('revise_status', 'not in', ('revise_issue'))]}"/>
                        <field name='revise_status' widget='statusbar' attrs="{'invisible':[('is_revise', '=', False)]}"/>
                    </group>
                    <group colspan="2" cols="6">
                        <field name ="is_revise" attrs="{'invisible':[('is_revise', '=', False)]}"/>
                        <field name ="revise_no" attrs="{'invisible':[('is_revise', '=', False)]}"/>
                        <field name="revise_flag" invisible="True"/>
                    </group>
                    <group>
                        <group colspan="2" col="6">
                            <field name='request_date'/>
                            <field name='request_no'/>
                            <field name='approved_date'/>
                            <field name='approved_by' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" />
                            <field name='issue_no'/>
                            <field name='issue_date'/>
                            <field name='issued_by' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" />
                            <field name='dept_id'  options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                            <field name='company_id'  options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                            <field name='location_id' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" />
                            <field name='batch_no' attrs="{'invisible':[('coming_from', 'in', ('Internal'))]}" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                            <field name='subplant_id' attrs="{'invisible':[('coming_from', 'in', ('Internal'))]}"/>
                        </group>
                        <group>
                            <field name="coming_from" invisible="True"/>
                            <field name="extraction_bom_id" invisible="True"/>
                            <field name="syrup_bom_id" invisible="True"/>
                            <field name="tablet_bom_id" invisible="True"/>  
                            <field name="powder_bom_id" invisible="True"/>                                
                            <field name="syrup_packing_bom_id" invisible="True"/>
                            <field name="tablet_packing_bom_id" invisible="True"/>
                            <field name="powder_packing_bom_id" invisible="True"/>
                        </group>
                        <group>
                            <field name='store_issue_no' invisible="True"/>
                            <field name='auto_no' invisible="True"/>
                            <field name='req_no_control_id' invisible="True"/>
                        </group>
                        <notebook colspan="2"> 
                            <page  string="Product Details">                 
                                <button name="check_stock" string="Check Stock" type="object"  attrs="{'invisible':[('status', 'in', ('issue'))]}"/>
                                <field name='grid_id'/>
                            </page> 
                            <page  string="Product Wise GRN List">
                                <field name='grn_line'>
                                    <tree string="Product Wise GRN List" editable='bottom' create="false">
                                        <field name="product_id" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                                        <field name="grn_id" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                                        <field name="received_qty"/>
                                        <field name="packing_style"/>
                                        <field name='packing_per_qty'/>
                                        <field name="extra_issued_packing" />
                                        <field name='issued_qty'/>
                                        <field name='extra_issued_qty'/>
                                        <field name="remarks" />
                                    </tree>
                                </field>
                            </page>
                            <page string="Other Details">
                                <group colspan="2" col="6">
                                    <field name='store_incharge' style="width:30%%" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" />
                                    <field name='plant_incharge' style="width:30%%" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" />
                                    <field name='doc_no' style="width:30%%"/>
                                    <field name='date' style="width:30%%"/>
                                    <field name='production_incharge' style="width:30%%" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" />
                                    <field name='remarks' style="width:30%%"/>
                                    <field name ="revise_remarks" placeholder='Enter Revise Remarks Here...' attrs="{'invisible': [('is_revise', '=', False)]}"/>
                                    <field name ="revise_id" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'invisible': [('is_revise', '=', False)]}"/>
                                    <field name ="revise_remarks_update" />
                                </group>
                            </page>
                        </notebook>
                    </group>
             </form>
            </field>
        </record>
	
        
         <!--  Tree view for Store Issue  item -->
         <record model="ir.ui.view" id="view_prakruti_store_issue_item_tree">
            <field name="name">prakruti.store_issue_item.tree</field>
            <field name="model">prakruti.store_issue_item</field>
            <field name="arch" type="xml">
                <tree string="Store Issue Item" editable='bottom' create= "false">
                    <field name="product_id" on_change="onchange_product(product_id)" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"  attrs="{'readonly':[('revise_issue_line', 'in',(0,2))]}"/>
                    <field name="uom_id" attrs="{'readonly':[('revise_issue_line', 'in',(0,2))]}" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name="description" attrs="{'readonly':[('revise_issue_line', 'in',(0,2))]}" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name="packing_style" attrs="{'readonly':[('style_flag', '=', 1)]}"/>
                    <field name="packing_per_qty" attrs="{'readonly':[('packing_flag', '=', 1)]}"/>
                    <field name="extra_issued_packing" attrs="{'readonly':[('packing_flag', '=', 1)]}"/>
                    <field name="store_qty" readonly="1" />
                    <field name='reserved_qty'/>
                    <field name="grn_no" invisible="1"/> 
                    <field name="grn_list" />
                    <field name="packing_details" />
                    <field name='ar_no' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" domain="[ ('product_id','=',product_id)]" />
                    <field name="approved_quantity" attrs="{'readonly':[('revise_issue_line', 'in',(0,2))]}"/>
                    <field name="issued_quantity" />
                    <field name="extra_issued_qty" attrs="{'readonly':[('extra_readonly_flag', '=', 1)]}"/>
                    <field name="remarks"/>
                    <field name='slip_id' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"/>
                    <field name="qty_returned" readonly="1"/>
                    <field name="grid_common_id_bom" invisible="True"/>
                    <field name="extra_readonly_flag" invisible="True"/>
                    <field name="main_id" invisible="True"/>
                    <field name="style_flag" invisible="True"/>
                    <field name="packing_flag" invisible="True"/>
                    <field name="revise_issue_line" invisible="1" />
                    <field name="request_line_id" invisible="True"/>
                    <field name="requested_quantity" invisible="True"/>
                    <button name="action_purchase_grn" icon="gtk-go-forward" string="Select GRN Number" type="object" />
                </tree>
            </field>
        </record>
        
        
        
         <!--  Pivot for Store Issue   -->
     <record model="ir.ui.view" id="view_prakruti_store_issue_pivot">
            <field name="name">prakruti.store_issue.pivot</field>
            <field name="model">prakruti.store_issue</field>
            <field name="arch" type="xml">
                <pivot string="Store Issue " display_quantity="True">
                    <field name="status" type="row"/>
                    <field name="issued_by"/>
                </pivot>
            </field>
        </record>
        
        

        <!-- Action for    Store Issue -->
        <record model="ir.actions.act_window" id="prakruti_store_issue_action">
            <field name="name">Store Issue</field>
            <field name="res_model">prakruti.store_issue</field>
            <field name="view_type">form</field>
            <field name="domain">[('revise_flag','=',0)]</field>
            <field name="view_mode">tree,form,pivot</field>
        </record>
	
	
        <menuitem name="Material Issue" 
                  id="prakruti_store_issue_menu"
                  action="prakruti_store_issue_action" 
                  sequence="3"
                  parent="prakruti_sotres_main_sub_menu"
                  groups="group_prakruti_store_issue_read_only,group_prakruti_store_issue_edit,group_prakruti_store_issue_create,group_prakruti_store_issue_delete"/>

      
   

</data>
</openerp>
