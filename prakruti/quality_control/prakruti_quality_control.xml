<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <!--Search view for Quality Control          -->
        <record model="ir.ui.view" id="view_prakruti_quality_control_search">
            <field name="name">prakruti.quality_control.search</field>
            <field name="model">prakruti.quality_control</field>
            <field name="arch" type="xml">
                <search string="Product Wise Search">
                    <field name="product_id"/>
                    <field name="grn_no"/>
                    <field name='po_no'/>
                    <field name='pr_no'/>
                    <field name="state"/>
                </search>
            </field>
        </record>
        
        
        <!--Tree view for Quality Control  -->
        <record model="ir.ui.view" id="view_prakruti_quality_control_tree">
            <field name="name">Quality Control</field>
            <field name="model">prakruti.quality_control</field>
            <field name="arch" type="xml">
                <tree string="Quality Control" create= "false">
                    <field name="qc_date"/>
                    <field name="grn_no"/>
                    <field name="grn_date"/>
                    <field name='po_no'/>
                    <field name="order_date"/>
                    <field name='pr_no'/>
                    <field name="request_date" />
                    <field name="state"/>
                </tree>
            </field>
        </record>  
        
        <!--Form view for Quality Control          -->
        <record model="ir.ui.view" id="view_prakruti_quality_control_form">
            <field name="name">Quality Control</field>
            <field name="model">prakruti.quality_control</field>
            <field name="arch" type="xml">
                <form string="Quality Control" create= "false">
                    <header position="inside">
                        <button name="validate" string="Validate" type="object" attrs="{'invisible':[('flag_rejected_count','in',(2,3,4))]}"/>
                        <button name="quality_to_ha" string="To HA" type="object" attrs="{'invisible':[('flag_rejected_count','in',(1,3,4))]}"/>
                        <button name="update_to_grn" string="Update to GRN" type="object" attrs="{'invisible':['|',('flag_rejected_count','in',(2,3,1)),('state','in',('accepted','qc','qc_ha','sent_to_grn'))]}"/>
                    </header>
                    <group colspan="2" col="6">
                        <field name="qc_date"/>
                        <field name='grn_no' readonly= "True"/>
                        <field name='grn_date' readonly= "True"/>
                        <field name='po_no' readonly= "True"/>
                        <field name="request_date" readonly= "True"/>
                        <field name="order_date" readonly= "True"/>
                        <field name='vendor_id' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" readonly= "True"/>
                        <field name='prepared_by' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" readonly= "True"/>
                        <field name='company_address' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" readonly= "True"/>
                        <field name='delivery_address' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" readonly= "True"/>
                        <field name='state' readonly= "True"/>
                        <field name="flag_rejected_count" invisible= "True"/>
                        <field name='dispatch_through' invisible= "True"/>
                    </group>
                    <notebook>
                        <page string='Product Details'>
                            <field name='control_line' attrs="{'readonly':[('state','in',('validate','qc_ha','done','sent_to_grn','accepted','accepted_under_deviation','rejected'))]}"/>
                            <group invisible="True">
                                <group class="oe_subtotal_footer oe_right" invisible="True">
                                    <field name='amount_untaxed'/>
                                    <field name='frieght_charges_applied'/>
                                    <field name='frieght_charges'/>
                                    <field name='packing_charges'/>
                                    <field name='additional_charges'/>
                                    <field name='excise_duty'/>
                                    <field name='total_discount' readonly= "True"/>
                                    <field name='total_tax' readonly= "True"/>
                                    <field name='total_excise_duty' readonly= "True"/>
                                    <field name='grand_total' readonly= "True"/>
                                </group>
                            </group>
                        </page>
                        <page string='Other details'>
                            <group name = 'store_details' string = 'Store Information'/>
                            <group colspan="2" col="6">
                                <field name= "payment" invisible= "True"/>
                                <field name= 'destination' invisible= "True"/>
                                <field name= 'other_reference' invisible= "True"/>
                                <field name= "maintanence_manager" invisible= "True"/>
                                <field name= 'terms_of_delivery' invisible= "True"/>
                            </group>
                            <group colspan="2" col="6">
                                <field name ="quality_incharge" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" attrs="{'readonly':[('state','in',('validate','qc_ha','done','sent_to_grn','accepted','accepted_under_deviation','rejected'))]}"/>
                                <field name ="stores_incharge" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" readonly= "True"/>
                                <field name ="purchase_manager" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" readonly= "True"/>
                                <field name ="plant_manager" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" readonly= "True"/>
                                <field name ="to_name" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" readonly= "True"/>
                                <field name ="document_no" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" readonly= "True"/>
                                <field name ="revision_no" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" readonly= "True"/>
                                <field name ="default_pr_date" options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}" readonly= "True"/>
                            </group>
                            <group name= 'document_details' string= 'Documents Details' invisible= "True"/>
                            <group colspan="2" col="6" invisible= "True">
                                <field name= 'gc_no' attrs="{'readonly':[('state','in',('validate','qc_ha','done','sent_to_grn','accepted','accepted_under_deviation','rejected'))]}"/>
                                <field name= 'gc_date' attrs="{'readonly':[('state','in',('validate','qc_ha','done','sent_to_grn','accepted','accepted_under_deviation','rejected'))]}"/>
                                <field name= 'dc_no' attrs="{'readonly':[('state','in',('validate','qc_ha','done','sent_to_grn','accepted','accepted_under_deviation','rejected'))]}"/>
                                <field name= 'dc_date' attrs="{'readonly':[('state','in',('validate','qc_ha','done','sent_to_grn','accepted','accepted_under_deviation','rejected'))]}"/>
                                <field name= 'doc_no' readonly= "True"/>
                                <field name= 'rev_no' readonly= "True"/>
                                <field name= 'doc_date' readonly= "True"/>
                                <field name= 'remarks' attrs="{'readonly':[('state','in',('validate','qc_ha','done','sent_to_grn','accepted','accepted_under_deviation','rejected'))]}"/>
                                <field name= 'grn_remarks' attrs="{'readonly':[('state','in',('validate','qc_ha','done','sent_to_grn','accepted','accepted_under_deviation','rejected'))]}"/>
                            </group>
                            <group name= 'transporter_details' string= 'Transporter Details' invisible= "True"/>
                            <group colspan="2" col="6" invisible= "True">
                                <field name= 'transporter_name' attrs="{'readonly':[('state','in',('validate','qc_ha','done','sent_to_grn','accepted','accepted_under_deviation','rejected'))]}"/>
                                <field name= 'transporter_payment_details' attrs="{'readonly':[('state','in',('validate','qc_ha','done','sent_to_grn','accepted','accepted_under_deviation','rejected'))]}"/>
                            </group>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>

    <!-- Tree view for Quality Control         -->
        <record model="ir.ui.view" id="view_prakruti_quality_control_line_tree">
            <field name="name">Quality Control</field>
            <field name="model">prakruti.quality_control_line</field>
            <field name="arch" type="xml">
                <tree editable='bottom' create= "false">
                    <field name='batch_no' invisible="True"/>
                    <field name='product_id' readonly="True"/>
                    <field name='description' readonly="True"/>
                    <field name='uom_id' readonly="True"/>
                    <field name='actual_quantity' invisible="True"/>
                    <field name='packing_style' invisible="True"/>
                    <field name='received_per_qty' invisible="True"/>
                    <field name='quantity' readonly="True"/>
                    <field name="accepted_qty" />
                    <field name="rejected_qty"/>
                    <field name='status'/>
                    <field name='test_result' />
                    <field name='specification_id' options="{'no_create': True, 'no_create_edit' : True}" domain="['&amp;',('product_id','=',product_id),'|',('specification_purchase_status','=',True),('common_specification','=',True)]"/>
                    <field name='ar_no' options="{'no_create': True, 'no_open': True, 'no_create_edit' : True}"  domain="[('specification_id','=',specification_id)]"/>
                    <field name='unit_price' invisible="True"/>
                    <field name='remarks'/>
                    <field name='scheduled_date' invisible="True"/>
                    <field name='discount' invisible="True"/>
                    <field name='tax_id' invisible="True"/>
                    <field name='tax_price'  invisible="True"/>
                    <field name='subtotal' invisible="True"/>
                    <field name='grn_grid_common_id' invisible="True"/>
                    <field name='qc_common_id' invisible="True"/>
                    <field name='control_id' invisible="True"/>
                </tree>
            </field>
        </record>  
        
    <!-- Pivot for Quality Control         -->
     <record model="ir.ui.view" id="view_prakruti_quality_control_pivot">
            <field name="name">prakruti.quality_control.pivot</field>
            <field name="model">prakruti.quality_control</field>
            <field name="arch" type="xml">
                <pivot string=" Quality Control" display_quantity="True">
                    <field name="vendor_id" type="row"/>
                    <field name="prepared_by"/>
                    <field name="state"/>
                </pivot>
            </field>
        </record>
        
    <!--Action FOR Quality Control  -->
        <record model="ir.actions.act_window" id="prakruti_quality_control_action">
            <field name="name">Quality Control</field>
            <field name="res_model">prakruti.quality_control</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,pivot</field>
        </record>
        
        <menuitem name="Quality Control" 
                  id="prakruti_quality_control_main_menu" 
                  sequence="4"  
                  web_icon="prakruti,static/src/img/icons/QC.jpg"/>
        
        <menuitem name="Inward" 
                  id="prakruti_quality_control_parent_menu" 
                  parent="prakruti_quality_control_main_menu" 
                  sequence="1" />
        
        <menuitem sequence= "1"
                  name=" Inward Quality Control" 
                  id="prakruti_quality_control_child_menu" 
                  action="prakruti_quality_control_action" 
                  parent="prakruti_quality_control_parent_menu"
                  groups="prakruti.group_prakruti_quality_control_read_only,prakruti.group_prakruti_quality_control_edit,prakruti.group_prakruti_quality_control_create,prakruti.group_prakruti_quality_control_delete"/>
        
    </data>
</openerp>